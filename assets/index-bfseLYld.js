import{j as t,d as $,r as u,b as _,c as F,e as P,g as V}from"./index-BaYKvzSN.js";import{g as E,e as H,c as G,S as R,a as q}from"./swiper-P1ySR95k.js";import{u as z}from"./index-WCSSVJ-j.js";import"./Breadcrumbs-B7ea65wc.js";function X({title:o}){return t.jsxs("span",{className:"flex items-center",children:[t.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),t.jsx("span",{className:"shrink-0 px-4 text-gray-900 dark:text-white font-bold text-2xl",children:o||$}),t.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})}const C=u.memo(({id:o,title:e,data:a,onChange:s})=>t.jsxs("div",{className:"w-full flex flex-col bg-white p-2 rounded-2xl dark:text-gray-800",children:[t.jsx("label",{htmlFor:o,className:"text-gray-500 font-bold text-center",children:e||$}),t.jsx("select",{id:o,className:"w-full outline-none cursor-pointer p-1",onChange:s,children:a.map(r=>t.jsx("option",{value:r.id,children:r.name},r.id))})]}));function J({setDataOption:o,setOpen:e,callGenerate:a}){const[s,r]=u.useState({level:"",soluongthe:"",theloai:""}),[d,c]=u.useState(!1),n=p=>m=>{r({...s,[p]:m.target.value})};u.useEffect(()=>{c(s.level!==""&&s.soluongthe!==""&&s.theloai!==""),o(s)},[s]);const l=[{id:"",name:"Lựa chọn trình độ"},{id:"n1",name:"N1"},{id:"n2",name:"N2"},{id:"n3",name:"N3"},{id:"n4",name:"N4"},{id:"n5",name:"N5"}],i=[{id:"",name:"Lựa chọn thể loại"},{id:"tuvungkanji",name:"Từ vựng Kanji"},{id:"cautrucnguphap",name:"Cấu trúc ngữ pháp"}],h=[{id:"",name:"Lựa chọn số lượng thẻ"},{id:"10",name:"10"},{id:"15",name:"15"},{id:"20",name:"20"}];return t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"w-full bg-gray-400 p-5 rounded-t-2xl grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-5 gap-5",children:[t.jsx(C,{id:"level",title:"Trình độ",data:l,onChange:n("level")}),t.jsx(C,{id:"soluongthe",title:"Số lượng thẻ",data:h,onChange:n("soluongthe")}),t.jsx(C,{id:"theloai",title:"Thể loại",data:i,onChange:n("theloai")})]}),t.jsxs("button",{onClick:()=>{d?(e(!0),a(s)):alert("Vui lòng chọn đầy đủ thông tin trên form.")},disabled:!d,className:`w-full flex cursor-pointer items-center justify-center bg-gray-800 text-white dark:bg-white p-2 rounded-b-2xl dark:text-gray-800 hover:bg-sky-800 hover:text-white transition-all ${d?"":"opacity-50 cursor-not-allowed"}`,children:[t.jsx("img",{src:"https://ai-bo.jp/wp-content/uploads/2023/12/image-19-1024x1024.png",alt:"Tạo thẻ học flashcard",className:"h-5"}),t.jsx("p",{children:"Tạo flashcard"})]})]})}function U(o){const{effect:e,swiper:a,on:s,setTranslate:r,setTransition:d,overwriteParams:c,perspective:n,recreateShadows:l,getEffectParams:i}=o;s("beforeInit",()=>{if(a.params.effect!==e)return;a.classNames.push(`${a.params.containerModifierClass}${e}`),n&&n()&&a.classNames.push(`${a.params.containerModifierClass}3d`);const p=c?c():{};Object.assign(a.params,p),Object.assign(a.originalParams,p)}),s("setTranslate",()=>{a.params.effect===e&&r()}),s("setTransition",(p,m)=>{a.params.effect===e&&d(m)}),s("transitionEnd",()=>{if(a.params.effect===e&&l){if(!i||!i().slideShadows)return;a.slides.forEach(p=>{p.querySelectorAll(".swiper-slide-shadow-top, .swiper-slide-shadow-right, .swiper-slide-shadow-bottom, .swiper-slide-shadow-left").forEach(m=>m.remove())}),l()}});let h;s("virtualUpdate",()=>{a.params.effect===e&&(a.slides.length||(h=!0),requestAnimationFrame(()=>{h&&a.slides&&a.slides.length&&(r(),h=!1)}))})}function Y(o,e){const a=E(e);return a!==e&&(a.style.backfaceVisibility="hidden",a.style["-webkit-backface-visibility"]="hidden"),a}function Z(o){let{swiper:e,duration:a,transformElements:s,allSlides:r}=o;const{activeIndex:d}=e,c=n=>n.parentElement?n.parentElement:e.slides.find(i=>i.shadowRoot&&i.shadowRoot===n.parentNode);if(e.params.virtualTranslate&&a!==0){let n=!1,l;r?l=s:l=s.filter(i=>{const h=i.classList.contains("swiper-slide-transform")?c(i):i;return e.getSlideIndex(h)===d}),l.forEach(i=>{H(i,()=>{if(n||!e||e.destroyed)return;n=!0,e.animating=!1;const h=new window.CustomEvent("transitionend",{bubbles:!0,cancelable:!0});e.wrapperEl.dispatchEvent(h)})})}}function B(o,e,a){const s=`swiper-slide-shadow${` swiper-slide-shadow-${o}`}`,r=E(e);let d=r.querySelector(`.${s.split(" ").join(".")}`);return d||(d=G("div",s.split(" ")),r.append(d)),d}function K(o){let{swiper:e,extendParams:a,on:s}=o;a({cardsEffect:{slideShadows:!0,rotate:!0,perSlideRotate:2,perSlideOffset:8}}),U({effect:"cards",swiper:e,on:s,setTranslate:()=>{const{slides:c,activeIndex:n,rtlTranslate:l}=e,i=e.params.cardsEffect,{startTranslate:h,isTouched:p}=e.touchEventsData,m=l?-e.translate:e.translate;for(let w=0;w<c.length;w+=1){const v=c[w],M=v.progress,f=Math.min(Math.max(M,-4),4);let j=v.swiperSlideOffset;e.params.centeredSlides&&!e.params.cssMode&&(e.wrapperEl.style.transform=`translateX(${e.minTranslate()}px)`),e.params.centeredSlides&&e.params.cssMode&&(j-=c[0].swiperSlideOffset);let x=e.params.cssMode?-j-e.translate:-j,b=0;const k=-100*Math.abs(f);let y=1,T=-i.perSlideRotate*f,N=i.perSlideOffset-Math.abs(f)*.75;const S=e.virtual&&e.params.virtual.enabled?e.virtual.from+w:w,I=(S===n||S===n-1)&&f>0&&f<1&&(p||e.params.cssMode)&&m<h,D=(S===n||S===n+1)&&f<0&&f>-1&&(p||e.params.cssMode)&&m>h;if(I||D){const g=(1-Math.abs((Math.abs(f)-.5)/.5))**.5;T+=-28*f*g,y+=-.5*g,N+=96*g,b=`${-25*g*Math.abs(f)}%`}if(f<0?x=`calc(${x}px ${l?"-":"+"} (${N*Math.abs(f)}%))`:f>0?x=`calc(${x}px ${l?"-":"+"} (-${N*Math.abs(f)}%))`:x=`${x}px`,!e.isHorizontal()){const g=b;b=x,x=g}const A=f<0?`${1+(1-y)*f}`:`${1-(1-y)*f}`,O=`
        translate3d(${x}, ${b}, ${k}px)
        rotateZ(${i.rotate?l?-T:T:0}deg)
        scale(${A})
      `;if(i.slideShadows){let g=v.querySelector(".swiper-slide-shadow");g||(g=B("cards",v)),g&&(g.style.opacity=Math.min(Math.max((Math.abs(f)-.5)/.5,0),1))}v.style.zIndex=-Math.abs(Math.round(M))+c.length;const L=Y(i,v);L.style.transform=O}},setTransition:c=>{const n=e.slides.map(l=>E(l));n.forEach(l=>{l.style.transitionDuration=`${c}ms`,l.querySelectorAll(".swiper-slide-shadow").forEach(i=>{i.style.transitionDuration=`${c}ms`})}),Z({swiper:e,duration:c,transformElements:n})},perspective:()=>!0,overwriteParams:()=>({_loopSwapReset:!1,watchSlidesProgress:!0,loopAdditionalSlides:3,centeredSlides:!0,virtualTranslate:!e.params.cssMode})})}function Q(){const[o,e]=u.useState([]),a=_();return u.useEffect(()=>{const s=localStorage.getItem("AI_FlashCard");if(s){const r=a(s);e(r)}},[localStorage.getItem("AI_FlashCard")]),t.jsx("div",{className:"relative",children:t.jsx("div",{className:"mySwiper_AI_FlashCard z-0",children:t.jsx(R,{effect:"cards",grabCursor:!0,modules:[K],children:o.map(s=>t.jsx(q,{children:t.jsxs("div",{className:"group z-0 h-full  w-full p-2  perspective-midrange transition-all",children:[t.jsxs("span",{className:"text-base",children:["Thẻ số ",s.id]}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"text-2xl  left-0 w-full h-full backface-hidden z-10 transition-all duration-700 rotate-y-0 group-hover:rotate-y-180",children:t.jsx("p",{dangerouslySetInnerHTML:{__html:s.frontHTML}})}),t.jsx("div",{className:"back text-sm md:text-base absolute top-0 left-0 w-full h-full backface-hidden z-20 transition-all duration-700 rotate-y-180 group-hover:rotate-y-0",children:t.jsx("p",{dangerouslySetInnerHTML:{__html:s.backHTML}})})]})]})},s.id))})})})}const W=async function(o){const e=P(),{level:a,soluongthe:s,theloai:r}=o;let d=[];if(a==""||s==""||r=="")return alert("Vui lòng chọn đầy đủ thông tin trên form"),null;{const c=`
     Chỉ tạo chuỗi JSON như này với ${r}  tiếng nhật trình độ ${a} ngẫu nhiên không trùng lặp với số lượng ${s} item:
                 [
                 {
                     id: 1,
                     frontHTML: (
                         <div>
                             Câu hỏi ?
                         </div>
                     ),
                     backHTML: (
                     <div class="flex flex-col gap-2">
                         ${r==="cautrucnguphap"?t.jsxs("div",{children:[t.jsx("b",{children:"- Cách sử dụng -"}),t.jsx("div",{class:"flex flex-col",children:"vd : n + .... + .."})]}):t.jsx(t.Fragment,{})}
                         <div class="flex flex-col">
                             <b>- Giải thích -</b>
                             <p>Giải thích frontHTML</p>
                         </div>
                         <div>
                             <b>- Ví dụ -</b>
                             <div class="flex flex-col">
                                 lấy 5 ví dụ 
                                 <div class="flex flex-col"> 
                                     <div className="flex"><b>1. ví dụ</b></div>
                                     <div className="flex"><i>Dịch : .Dịch với tiếng Việt</i></div>
                                     <div className="flex"><i>Đọc: Dịch với tiếng nhật chữ hiragana</i></div>
                                 </div>
                                 ....
                             </div>
                         </div>
                         
                     </div>),
                 },
                 {
                     id: 2,
                     frontHTML: ... ,
                     backHTML:  ... ,
                 }
             ]
     `;try{const n=await V(c),l=String(n).replace(/```/g,"").replace(/```json/g,"").replace(/json/g,""),i=String(l).substring(String(l).indexOf("["),String(l).indexOf("]")+1);return d=JSON.parse(i),localStorage.setItem("AI_FlashCard",e(d)),d}catch(n){return console.log(n),alert(`Đã có lỗi phát sinh vui lòng tạo lại ! 
Cảm ơn !`),null}}};function re(){const[o,e]=u.useState(!1),[a,s]=u.useState(!1),[r,d]=u.useState({}),[c,n]=u.useState([]),[l,i]=u.useState(!1),h=z(),p=u.useCallback(async()=>{if(!l){alert("Vui lòng chọn đầy đủ thông tin trên form");return}s(!0);const m=await W(r);s(!1),m&&(n(m),e(!0))},[r,l]);return u.useEffect(()=>{i(r.level&&r.soluongthe&&r.theloai)},[r]),t.jsxs("div",{className:"stylepage h-full",children:[h,t.jsx(X,{title:"AI - Tạo Flashcard"}),t.jsx(J,{setDataOption:d,setOpen:e,callGenerate:p,canGenerate:l}),t.jsxs("div",{id:"AI_FlashCard_View",className:"w-full h-full my-10  flex justify-center items-center overflow-hidden",children:[t.jsx("b",{className:"text-red-800",children:"Thông báo : Chức năng đang phát triển và làm lại. "}),a&&t.jsxs("div",{className:"w-full h-full flex flex-col gap-5 justify-center items-center",children:[t.jsx(F,{}),t.jsx("p",{className:"animate-pulse",children:"AI : Đang tạo flashcard..."})]}),!a&&o&&c.length>0&&t.jsx(Q,{data:c,setOpen:e})]})]})}export{re as default};
