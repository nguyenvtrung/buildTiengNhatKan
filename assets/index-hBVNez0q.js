import{e as Q,g as be,r as l,j as e,I as A,T as he,R as ye}from"./index-lutZWs6c.js";import{u as je}from"./index-BAIyg-1O.js";import{A as we}from"./index-Dw9nCtVT.js";import{u as ve}from"./Model-D8dJEx4E.js";import{a as Ne,b as ke,c as Te,d as Se}from"./index-BqLkfznW.js";import{G as Ce}from"./iconBase-BezORLyK.js";import{a as Le}from"./index-CrkHQOkJ.js";import{B as ee}from"./ButtonVoidText-C9Lf42Ad.js";import{L as oe}from"./index-B7gDzLui.js";import{L as Re}from"./index-DQC8Kzhy.js";import"./Breadcrumbs-CL9ZdeCd.js";function Ee(n){return Ce({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M319.61 20.654c13.145 33.114 13.144 33.115-5.46 63.5 33.114-13.145 33.116-13.146 63.5 5.457-13.145-33.114-13.146-33.113 5.457-63.498-33.114 13.146-33.113 13.145-63.498-5.459zM113.024 38.021c-11.808 21.04-11.808 21.04-35.724 24.217 21.04 11.809 21.04 11.808 24.217 35.725 11.808-21.04 11.808-21.04 35.724-24.217-21.04-11.808-21.04-11.808-24.217-35.725zm76.55 56.184c-.952 50.588-.95 50.588-41.991 80.18 50.587.95 50.588.95 80.18 41.99.95-50.588.95-50.588 41.99-80.18-50.588-.95-50.588-.95-80.18-41.99zm191.177 55.885c-.046 24.127-.048 24.125-19.377 38.564 24.127.047 24.127.046 38.566 19.375.047-24.126.046-24.125 19.375-38.564-24.126-.047-24.125-.046-38.564-19.375zm-184.086 83.88c-1.191.024-2.36.07-3.492.134-18.591 1.064-41.868 8.416-77.445 22.556L76.012 433.582c78.487-20.734 132.97-21.909 170.99-4.615V247.71c-18.076-8.813-31.79-13.399-46.707-13.737a91.166 91.166 0 0 0-3.629-.002zm122.686 11.42c-2.916-.026-5.81.011-8.514.098-12.81.417-27.638 2.215-45.84 4.522V427.145c43.565-7.825 106.85-4.2 171.244 7.566l-39.78-177.197c-35.904-8.37-56.589-11.91-77.11-12.123zm2.289 16.95c18.889.204 36.852 2.768 53.707 5.02l4.437 16.523c-23.78-3.75-65.966-4.906-92.467-.98l-.636-17.805c11.959-2.154 23.625-2.88 34.959-2.758zm-250.483 4.658l-10.617 46.004h24.094l10.326-46.004H71.158zm345.881 0l39.742 177.031 2.239 9.973 22.591-.152-40.855-186.852h-23.717zm-78.857 57.82c16.993.026 33.67.791 49.146 2.223l3.524 17.174c-32.645-3.08-72.58-2.889-102.995 0l-.709-17.174c16.733-1.533 34.04-2.248 51.034-2.223zm-281.793 6.18l-6.924 30.004h24.394l6.735-30.004H56.389zm274.418 27.244c4.656.021 9.487.085 14.716.203l2.555 17.498c-19.97-.471-47.115.56-59.728 1.05l-.7-17.985c16.803-.493 29.189-.828 43.157-.766zm41.476.447c8.268.042 16.697.334 24.121.069l2.58 17.74c-8.653-.312-24.87-.83-32.064-.502l-2.807-17.234a257.25 257.25 0 0 1 8.17-.073zm-326.97 20.309l-17.985 77.928 25.035-.17 17.455-77.758H45.313zm303.164 11.848c19.608-.01 38.66.774 56.449 2.572l2.996 20.787c-34.305-4.244-85.755-7.697-119.1-3.244l-.14-17.922c20.02-1.379 40.186-2.183 59.795-2.193zm-166.606 44.05c-30.112.09-67.916 6.25-115.408 19.76l-7.22 2.053 187.759-1.27v-6.347c-16.236-9.206-37.42-14.278-65.13-14.196zm134.41 6.174c-19.63.067-37.112 1.439-51.283 4.182v10.064l177.594-1.203c-44.322-8.634-89.137-13.17-126.31-13.043zM26 475v18h460v-18H26z"},child:[]}]})(n)}function le(n,t,s,i,r,a,o){try{var c=n[a](o),h=c.value}catch(p){s(p);return}c.done?t(h):Promise.resolve(h).then(i,r)}function F(n){return function(){var t=this,s=arguments;return new Promise(function(i,r){var a=n.apply(t,s);function o(h){le(a,i,r,o,c,"next",h)}function c(h){le(a,i,r,o,c,"throw",h)}o(void 0)})}}var re,de;function Ie(){if(de)return re;de=1;var n="Expected a function",t=NaN,s="[object Symbol]",i=/^\s+|\s+$/g,r=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,o=/^0o[0-7]+$/i,c=parseInt,h=typeof Q=="object"&&Q&&Q.Object===Object&&Q,p=typeof self=="object"&&self&&self.Object===Object&&self,u=h||p||Function("return this")(),g=Object.prototype,I=g.toString,C=Math.max,b=Math.min,y=function(){return u.Date.now()};function x(d,f,j){var m,v,M,S,N,R,J=0,q=!1,D=!1,K=!0;if(typeof d!="function")throw new TypeError(n);f=k(f)||0,L(j)&&(q=!!j.leading,D="maxWait"in j,M=D?C(k(j.maxWait)||0,f):M,K="trailing"in j?!!j.trailing:K);function B(w){var $=m,X=v;return m=v=void 0,J=w,S=d.apply(X,$),S}function E(w){return J=w,N=setTimeout(z,f),q?B(w):S}function V(w){var $=w-R,X=w-J,ce=f-$;return D?b(ce,M-X):ce}function H(w){var $=w-R,X=w-J;return R===void 0||$>=f||$<0||D&&X>=M}function z(){var w=y();if(H(w))return Y(w);N=setTimeout(z,V(w))}function Y(w){return N=void 0,K&&m?B(w):(m=v=void 0,S)}function me(){N!==void 0&&clearTimeout(N),J=0,m=R=v=N=void 0}function fe(){return N===void 0?S:Y(y())}function ie(){var w=y(),$=H(w);if(m=arguments,v=this,R=w,$){if(N===void 0)return E(R);if(D)return N=setTimeout(z,f),B(R)}return N===void 0&&(N=setTimeout(z,f)),S}return ie.cancel=me,ie.flush=fe,ie}function L(d){var f=typeof d;return!!d&&(f=="object"||f=="function")}function T(d){return!!d&&typeof d=="object"}function P(d){return typeof d=="symbol"||T(d)&&I.call(d)==s}function k(d){if(typeof d=="number")return d;if(P(d))return t;if(L(d)){var f=typeof d.valueOf=="function"?d.valueOf():d;d=L(f)?f+"":f}if(typeof d!="string")return d===0?d:+d;d=d.replace(i,"");var j=a.test(d);return j||o.test(d)?c(d.slice(2),j?2:8):r.test(d)?t:+d}return re=x,re}var Me=Ie();const Ae=be(Me),G=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),De=n=>n===G;var te=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const ne=(...n)=>n.map(t=>t.trim()).join(" ").trim(),Oe=/\s*\((.*?)\)\s*/g,Pe=/(\(\?:[^)]+\))\?/g,Be=/(\(\?)?:\w+/g,He=/\*/g,ze=/[-{}[\]+?.,\\^$|#]/g,$e=n=>n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(ze,"\\$&").replace(Oe,"(?:$1)?").replace(Be,(t,s)=>s?t:"([^\\s]+)").replace(He,"(.*?)").replace(Pe,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i")),_e=(n,t)=>{if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;const s=new Map;for(let r=0;r<n.length-1;r++){const a=n.substring(r,r+2),o=s.has(a)?s.get(a)+1:1;s.set(a,o)}let i=0;for(let r=0;r<t.length-1;r++){const a=t.substring(r,r+2),o=s.has(a)?s.get(a):0;o>0&&(s.set(a,o-1),i++)}return 2*i/(n.length+t.length-2)},ue=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class ae{setSpeechRecognition(t){const s=!!t&&(De(t)||ue());s&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(s)}subscribe(t,s){this.subscribers[t]=s}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(s=>{const{onListeningChange:i}=this.subscribers[s];i(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(s=>{const{onMicrophoneAvailabilityChange:i}=this.subscribers[s];i(t)})}emitTranscriptChange(t,s){Object.keys(this.subscribers).forEach(i=>{const{onTranscriptChange:r}=this.subscribers[i];r(t,s)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{const{onClearTranscript:s}=this.subscribers[t];s()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(s=>{const{onBrowserSupportsSpeechRecognitionChange:i,onBrowserSupportsContinuousListeningChange:r}=this.subscribers[s];i(t),r(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&t.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:t,resultIndex:s}){const i=s===void 0?t.length-1:s;this.interimTranscript="",this.finalTranscript="";for(let a=i;a<t.length;++a)t[a].isFinal&&(!te()||t[a][0].confidence>0)?this.updateFinalTranscript(t[a][0].transcript):this.interimTranscript=ne(this.interimTranscript,t[a][0].transcript);let r=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=ne(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return F(function*({continuous:t=!1,language:s}={}){if(!this.recognition)return;const i=t!==this.recognition.continuous,r=s&&s!==this.recognition.lang;if((i||r)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=i?t:this.recognition.continuous,this.recognition.lang=r?s:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(a){a instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return F(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return F(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return F(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),te()&&(this.updateFinalTranscript=Ae(this.updateFinalTranscript,250,{leading:!0}))}}const ge="CLEAR_TRANSCRIPT",pe="APPEND_TRANSCRIPT",Je=()=>({type:ge}),Ve=(n,t)=>({type:pe,payload:{interimTranscript:n,finalTranscript:t}}),Fe=(n,t)=>{switch(t.type){case ge:return{interimTranscript:"",finalTranscript:""};case pe:return{interimTranscript:t.payload.interimTranscript,finalTranscript:ne(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};let W=!!G,Z=W&&!te(),O;const Ge=({transcribing:n=!0,clearTranscriptOnListen:t=!0,commands:s=[]}={})=>{const[i]=l.useState(_.getRecognitionManager()),[r,a]=l.useState(W),[o,c]=l.useState(Z),[{interimTranscript:h,finalTranscript:p},u]=l.useReducer(Fe,{interimTranscript:i.interimTranscript,finalTranscript:""}),[g,I]=l.useState(i.listening),[C,b]=l.useState(i.isMicrophoneAvailable),y=l.useRef(s);y.current=s;const x=()=>{u(Je())},L=l.useCallback(()=>{i.resetTranscript(),x()},[i]),T=(m,v,M)=>{const N=(typeof m=="object"?m.toString():m).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),R=_e(N,v);return R>=M?{command:m,commandWithoutSpecials:N,howSimilar:R,isFuzzyMatch:!0}:null},P=(m,v)=>{const S=$e(m).exec(v);return S?{command:m,parameters:S.slice(1)}:null},k=l.useCallback((m,v)=>{y.current.forEach(({command:M,callback:S,matchInterim:N=!1,isFuzzyMatch:R=!1,fuzzyMatchingThreshold:J=.8,bestMatchOnly:q=!1})=>{const D=!v&&N?m.trim():v.trim(),B=(Array.isArray(M)?M:[M]).map(E=>R?T(E,D,J):P(E,D)).filter(E=>E);if(R&&q&&B.length>=2){B.sort((z,Y)=>Y.howSimilar-z.howSimilar);const{command:E,commandWithoutSpecials:V,howSimilar:H}=B[0];S(V,D,H,{command:E,resetTranscript:L})}else B.forEach(E=>{if(E.isFuzzyMatch){const{command:V,commandWithoutSpecials:H,howSimilar:z}=E;S(H,D,z,{command:V,resetTranscript:L})}else{const{command:V,parameters:H}=E;S(...H,{command:V,resetTranscript:L})}})})},[L]),d=l.useCallback((m,v)=>{n&&u(Ve(m,v)),k(m,v)},[k,n]),f=l.useCallback(()=>{t&&x()},[t]);return l.useEffect(()=>{const m=_.counter;_.counter+=1;const v={onListeningChange:I,onMicrophoneAvailabilityChange:b,onTranscriptChange:d,onClearTranscript:f,onBrowserSupportsSpeechRecognitionChange:a,onBrowserSupportsContinuousListeningChange:c};return i.subscribe(m,v),()=>{i.unsubscribe(m)}},[n,t,i,d,f]),{transcript:ne(p,h),interimTranscript:h,finalTranscript:p,listening:g,isMicrophoneAvailable:C,resetTranscript:L,browserSupportsSpeechRecognition:r,browserSupportsContinuousListening:o}},_={counter:0,applyPolyfill:n=>{O?O.setSpeechRecognition(n):O=new ae(n);const t=!!n&&ue();W=t,Z=t},removePolyfill:()=>{O?O.setSpeechRecognition(G):O=new ae(G),W=!!G,Z=W&&!te()},getRecognitionManager:()=>(O||(O=new ae(G)),O),getRecognition:()=>_.getRecognitionManager().getRecognition(),startListening:({continuous:n,language:t}={})=>F(function*(){yield _.getRecognitionManager().startListening({continuous:n,language:t})})(),stopListening:()=>F(function*(){yield _.getRecognitionManager().stopListening()})(),abortListening:()=>F(function*(){yield _.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>W,browserSupportsContinuousListening:()=>Z};typeof window<"u"&&!window.SpeechRecognition&&window.webkitSpeechRecognition&&(window.SpeechRecognition=window.webkitSpeechRecognition,console.log("üì¢ [Polyfill] ƒê√£ k√≠ch ho·∫°t webkitSpeechRecognition cho m√¥i tr∆∞·ªùng Production."));const We=/[.,\/#!$%\^&\*;:{}=\-_`~()„ÄÇ„ÄÅÔºÅÔºü\s]/,se=n=>n?n.toLowerCase().replace(/[.,\/#!$%\^&\*;:{}=\-_`~()„ÄÇ„ÄÅÔºÅÔºü]/g,"").replace(/\s+/g,""):"",Ue=(n,t)=>{const s=se(n),i=se(t);if(!s||!i)return new Set;const r=s.length,a=i.length,o=Array.from(Array(r+1),()=>Array(a+1).fill(0));for(let u=1;u<=r;u++)for(let g=1;g<=a;g++)s[u-1]===i[g-1]?o[u][g]=o[u-1][g-1]+1:o[u][g]=Math.max(o[u-1][g],o[u][g-1]);let c=r,h=a;const p=new Set;for(;c>0&&h>0;)s[c-1]===i[h-1]?(p.add(h-1),c--,h--):o[c-1][h]>o[c][h-1]?c--:h--;return p},Xe=(n,t)=>{const s=new Set;let i=0;for(let r=0;r<t.length;r++){const a=t[r];We.test(a)||(n.has(i)&&s.add(r),i++)}return s},qe=(n,t="ja-JP")=>{const[s,i]=l.useState(0),[r,a]=l.useState(new Set),{transcript:o,listening:c,resetTranscript:h,browserSupportsSpeechRecognition:p,isMicrophoneAvailable:u}=Ge(),g=()=>p?(u||console.warn("‚ö†Ô∏è [W] Kh√¥ng t√¨m th·∫•y Microphone ho·∫∑c ch∆∞a c·∫•p quy·ªÅn. H√£y ki·ªÉm tra c√†i ƒë·∫∑t tr√¨nh duy·ªát."),!0):(console.error("‚ùå [E] Tr√¨nh duy·ªát kh√¥ng h·ªó tr·ª£ Web Speech API."),!1),I=()=>{if(console.log("üé§ [A] Ng∆∞·ªùi d√πng nh·∫•n b·∫Øt ƒë·∫ßu n√≥i..."),!!g()){i(0),a(new Set),h();try{_.startListening({continuous:!0,language:t}),console.log(`‚úÖ [S] ƒêang nghe v·ªõi ng√¥n ng·ªØ: ${t}`)}catch(y){console.error("‚ùå [E] L·ªói khi g·ªçi start Listening:",y)}}},C=()=>{},b=(y=!1)=>{if(!o)return;const x=Ue(o,n),L=Xe(x,n);if(a(L),y){const T=se(n),P=x.size,k=T.length;if(k===0)return;let d=P/k*100;se(o).length>k*1.5&&(alert("‚ö†Ô∏è [√ö √π] B·ªã ph·∫°t ƒëi·ªÉm do n√≥i qu√° d√†i so v·ªõi ƒë√°p √°n. /n Ch√≠nh s√°ch: Tr√°nh spam n√≥i qu√° d√†i (L√® nh√† l√® nh√® ^^ )"),d*=.8);const f=d>=90?100:Math.floor(d);i(f)}};return l.useEffect(()=>{c&&b(!1)},[o,c,n]),l.useEffect(()=>{!c&&o&&b(!0)},[c,o,n]),{transcript:o,listening:c,score:s,matchedIndices:r,startListening:I,stopListening:C,isSupported:p,hasMic:u}},Ke=l.memo(({text:n,matchedIndices:t})=>e.jsx("div",{className:"text-xl sm:text-2xl font-medium leading-relaxed flex flex-wrap gap-x-1 text-left",children:n.split("").map((s,i)=>e.jsx("span",{className:`transition-colors duration-200 ${t.has(i)?"text-green-600 font-bold":"text-gray-400"}`,children:s},i))})),Ye=l.memo(({setStatus:n})=>e.jsx("div",{className:"flex items-center gap-1 cursor-pointer bg-gray-100 text-gray-600 hover:bg-gray-200 p-2 rounded-full transition-all",onClick:()=>n(!1),children:e.jsx(A,{iconName:"faClose"})})),Qe=l.memo(({score:n})=>e.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 mt-2",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"ƒê·ªô ch√≠nh x√°c"}),e.jsxs("span",{className:`text-lg font-black ${n>=80?"text-green-600":"text-orange-500"}`,children:[n,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-1000 ease-out ${n>=80?"bg-green-500":"bg-orange-500"}`,style:{width:`${n}%`}})})]})),Ze=({value:n,language:t,setStatus:s})=>{const i=n||"„Åì„Çì„Å´„Å°„ÅØ",r=t||"ja-JP";l.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]);const{transcript:a,listening:o,score:c,matchedIndices:h,startListening:p,stopListening:u,isSupported:g}=qe(i,r);return g?e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[100] p-4 bg-black/60 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white w-full max-w-lg max-h-[90vh] rounded-[24px] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in duration-300",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-white z-10",children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2 uppercase tracking-wide",children:[e.jsx(Ne,{className:"text-blue-500 text-xl"})," Luy·ªán n√≥i"]}),e.jsx(Ye,{setStatus:s})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 border border-gray-100 shadow-sm mb-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("span",{className:"text-[10px] font-black text-blue-400 uppercase tracking-widest bg-blue-50 px-2 py-1 rounded",children:"N·ªôi dung"}),e.jsx(ee,{text:i,language:r})]}),e.jsx("div",{className:"break-words",children:e.jsx(Ke,{text:i,matchedIndices:h})})]}),(a||c>0)&&e.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm animate-in fade-in",children:[e.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase mb-1",children:"B·∫°n ƒë√£ n√≥i"}),e.jsx("p",{className:"text-gray-600 italic text-sm mb-2 break-words",children:a?`"${a}"`:"..."}),!o&&c>0&&e.jsx(Qe,{score:c})]})]}),e.jsxs("div",{className:"p-4 border-t border-gray-100 bg-white flex flex-col items-center z-10",children:[e.jsxs("div",{className:"relative group",children:[o&&e.jsx("div",{className:"absolute inset-0 bg-red-400 rounded-full animate-ping opacity-20 scale-150"}),e.jsx("button",{onMouseDown:p,onMouseUp:u,onMouseLeave:u,onTouchStart:p,onTouchEnd:u,className:`relative z-10 w-20 h-20 rounded-full flex items-center justify-center transition-all duration-300 shadow-xl select-none touch-none ${o?"bg-red-500 scale-110 shadow-red-200":"bg-gradient-to-br from-blue-500 to-blue-600 hover:scale-105 shadow-blue-200 active:scale-95"}`,children:o?e.jsx(ke,{size:36,className:"text-white"}):e.jsx(Te,{size:32,className:"text-white"})})]}),e.jsx("p",{className:`mt-3 text-xs font-bold tracking-wide uppercase ${o?"text-red-500 animate-pulse":"text-gray-400"}`,children:o?"ƒêang thu √¢m...":"Nh·∫•n gi·ªØ ƒë·ªÉ n√≥i"})]})]})}):null};function xe({value:n,language:t}){const[s,i]=l.useState(!1);return e.jsxs("div",{children:[e.jsx(he,{title:s?"T·∫Øt ƒë·ªçc":"ƒê·ªçc",className:"cursor-pointer mt-1 p-1 rounded-full shadow shadow-gray-800",onClick:()=>{i(!s)},children:e.jsx(A,{iconName:s?"faMicrophoneLinesSlash":"faMicrophoneLines",className:`${s?"bg-sky-500 text-white":""} transition-all aspect-1/1  text-gray-800 dark:text-white`})}),s&&e.jsx(Ze,{value:n,language:t,setStatus:i})]})}const et=l.memo(({title:n})=>e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),e.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:n}),e.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]}));function tt({title:n}){const{inputText:t,aiCallBack:s,isLoading:i,error:r}=l.useContext(U),{romaji:a,japanese:o}=s||{},c=()=>i?e.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[e.jsx(oe,{}),e.jsx("p",{className:"text-sky-800 animate-pulse",children:"ƒêang ph√¢n t√≠ch"})]}):r?e.jsxs("p",{className:"text-red-500",children:["L·ªói: ",r.message||"ƒê√£ c√≥ l·ªói x·∫£y ra"]}):t?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{className:"text-sky-800",children:"N·ªôi dung:"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ee,{text:t,language:"vi-VN"}),e.jsx("p",{children:t})]})]}),o&&e.jsxs("div",{children:[e.jsx("b",{className:"text-sky-800",children:"D·ªãch:"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx(ee,{text:o,language:"ja-JP"}),e.jsx(xe,{value:o,language:"ja-JP"}),e.jsx("p",{children:o})]})]}),a&&e.jsxs("div",{children:[e.jsx("b",{className:"text-sky-800 italic text-sm",children:"C√°ch ƒë·ªçc:"}),e.jsx("p",{children:a})]})]}):e.jsx("p",{children:"Vui l√≤ng nh·∫≠p n·ªôi dung c·∫ßn d·ªãch."});return e.jsxs("div",{className:"w-full shadow shadow-gray-400  rounded-b-2xl p-5 ",children:[e.jsx(et,{title:n||"D·ªãch - C√°ch ƒë·ªçc"}),c()]})}const nt=l.memo(({title:n})=>e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),e.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:n}),e.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),st=l.memo(({item:n})=>{const{special_structure:t,html:s,analysis:i}=n||{},r=o=>o?o.replace(/A„ÅÑ/g,"A<sub>„ÅÑ</sub><sub class='text-gray-800 italic'>( T√≠nh t·ª´ ƒëu√¥i „ÅÑ)</sub>").replace(/A„Å™/g,"A<sub>„Å™</sub><sub class='text-gray-800 italic'>( T√≠nh t·ª´ ƒëu√¥i „Å™)</sub>").replace(/V(„Çã|„Å¶|„Åü|„Å™„ÅÑ)/g,"V<sub>$1</sub>").replace("V-masu","V<sub>„Åæ„Åô</sub>").replace("N/Na-adj","N<sub class='text-gray-800 italic'>( Danh t·ª´ )</sub>").replace(/\*\*(.*?)\*\*/g,"<br><b>$1</b><br>"):"",a=l.useMemo(()=>r(String(t)||""),[t]);return e.jsx(he,{title:`Chi ti·∫øt c·∫•u tr√∫c:${t}`||"",placement:"top",arrow:!0,children:e.jsxs("details",{className:"group cursor-pointer p-3 border-b last:border-0 border-gray-100 dark:border-gray-700",children:[e.jsx("summary",{className:"flex items-center justify-between list-none outline-none",children:e.jsx("div",{className:"text-sky-800 dark:text-sky-400 font-bold text-lg hover:text-sky-600 transition-colors",dangerouslySetInnerHTML:{__html:a}})}),e.jsx("div",{className:"grid grid-rows-[0fr] transition-all duration-300 ease-in-out group-open:grid-rows-[1fr]",children:e.jsx("div",{className:"overflow-hidden",children:e.jsx("div",{className:"pt-3 pl-4 border-l-2 border-gray-200 dark:border-gray-600 ml-1 mt-1",children:e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:i})})})})]})})});function it({title:n}){const{aiCallBack:t,isLoading:s,error:i}=l.useContext(U),{list_structure:r}=t||{};return e.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[e.jsx(nt,{title:n||"Ph√¢n t√≠ch"}),s&&e.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[e.jsx(oe,{}),e.jsx("p",{className:"text-sky-800 animate-pulse",children:"ƒêang ph√¢n t√≠ch"})]}),(r==null?void 0:r.length)>0&&!s&&e.jsx("div",{className:"mt-2",children:e.jsx("ul",{className:" list-inside flex  flex-col gap-5",children:r.map((a,o)=>e.jsx("li",{className:"shadow shadow-gray-400 p-2 rounded-2xl",children:e.jsx(st,{item:a})},o))})}),!s&&(!r||r.length===0)&&e.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Kh√¥ng t√¨m th·∫•y c·∫•u tr√∫c ng·ªØ ph√°p ƒë·∫∑c bi·ªát."})]})}const rt=l.memo(({title:n})=>e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),e.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:n}),e.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),at=l.memo(({item:n})=>e.jsxs("li",{className:"w-full h-full shadow shadow-gray-400 p-2 rounded-2xl bg-white dark:bg-gray-900",children:[e.jsxs("div",{className:"flex justify-between items-center gap-2",children:[e.jsxs("div",{className:"flex gap-2 items-center text-xl text-sky-800 dark:text-sky-200",children:[e.jsx(Re,{}),e.jsx("span",{className:"font-Japan font-bold",children:n==null?void 0:n.word})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(ee,{text:n==null?void 0:n.word,language:"ja-JP"}),e.jsx(xe,{value:n==null?void 0:n.word,language:"ja-JP"})]})]}),e.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-xl p-2 mt-2",children:e.jsx("p",{className:"text-sm lg:text-base",children:n==null?void 0:n.meaning})})]}));function ot({title:n}){const{aiCallBack:t,isLoading:s,error:i}=l.useContext(U),{list_vocabulary:r}=t||{};return e.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[e.jsx(rt,{title:n||"Ph√¢n t√≠ch"}),s&&e.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[e.jsx(oe,{}),e.jsx("p",{className:"text-sky-800 animate-pulse",children:"ƒêang ph√¢n t√≠ch"})]}),(r==null?void 0:r.length)>0&&!s&&e.jsx("div",{className:"mt-2",children:e.jsx("ul",{className:" grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-5",children:r.map((a,o)=>{const c=a!=null&&a.word?`${a.word}-${o}`:o;return e.jsx(at,{item:a},c)})})}),!s&&(!r||r.length===0)&&e.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Kh√¥ng t√¨m th·∫•y t·ª´ v·ª±ng ƒë·∫∑c bi·ªát."})]})}const ct=l.memo(ot);function lt({aiCallBack:n}){const[t,s]=ye.useState("tab1");l.useEffect(()=>{n&&s("tab1")},[n]);const i=(r,a)=>"dark:text-white flex-1 text-center py-1  px-4 flex items-center justify-center gap-2 text-lg font-medium border-b-4 transition-all duration-300 "+(a===r?"border-indigo-700 text-indigo-800":"border-transparent text-gray-600  hover:text-gray-800 hover:border-gray-300 dark:hover:text-white");return e.jsxs("section",{children:[e.jsxs("nav",{className:"flex justify-between bg-white dark:bg-gray-800  border-b border-gray-200 rounded-t-lg",children:[e.jsxs("button",{onClick:()=>s("tab1"),className:i("tab1",t),children:[e.jsx(Se,{className:"text-xl"}),e.jsx("span",{className:"hidden md:block",children:"D·ªãch - c√°ch ƒë·ªçc"})]}),e.jsxs("button",{onClick:()=>s("tab2"),className:i("tab2",t),children:[e.jsx(Ee,{className:"text-xl"}),e.jsx("span",{className:"hidden md:block",children:"Ph√¢n t√≠ch c·∫•u tr√∫c"})]}),e.jsxs("button",{onClick:()=>s("tab3"),className:i("tab3",t),children:[e.jsx(Le,{className:"text-xl"}),e.jsx("span",{className:"hidden md:block",children:"Danh s√°ch t·ª´ v·ª±ng"})]})]}),e.jsxs("div",{className:"",children:[t==="tab1"&&e.jsx(tt,{title:"D·ªãch"}),t==="tab2"&&e.jsx(it,{title:"C·∫•u tr√∫c"}),t==="tab3"&&e.jsx(ct,{title:"T·ª´ v·ª±ng"})]})]})}function dt(){const{aiCallBack:n,isLoading:t}=l.useContext(U);return e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col  md:flex-row justify-between gap-2 items-center",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(A,{iconName:"faCrown",className:"text-2xl text-yellow-500"}),e.jsx("h1",{className:"text-2xl font-bold",children:"Ph√¢n t√≠ch"})]}),e.jsx("h5",{className:"text-gray-400 text-sm italic",children:location.href})]}),e.jsx("div",{className:"flex flex-col gap-5 select-text mt-2",children:e.jsx(lt,{aiCallBack:n})})]})}function ht({onClose:n,onRepeat:t}){const[s,i]=l.useState([]),r=()=>{try{const c=localStorage.getItem("dichHistory");if(c){const p=JSON.parse(c).map(u=>{const g=atob(u),I=decodeURIComponent(g);return JSON.parse(I)});i(p)}else i([])}catch(c){console.error("Failed to load history from localStorage:",c),localStorage.removeItem("dichHistory"),i([])}};l.useEffect(()=>{r()},[]);const a=()=>{window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a TO√ÄN B·ªò l·ªãch s·ª≠ d·ªãch? Thao t√°c n√†y kh√¥ng th·ªÉ ho√†n t√°c.")&&(localStorage.removeItem("dichHistory"),i([]))},o=c=>{if(window.confirm("B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën x√≥a m·ª•c n√†y?")){const h=s.filter(u=>u.id!==c),p=h.map(u=>{const g=JSON.stringify(u);return btoa(encodeURIComponent(g))});localStorage.setItem("dichHistory",JSON.stringify(p)),i(h)}};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex justify-center items-center",onClick:n,children:e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-[90%] max-w-2xl max-h-[80vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[e.jsxs("header",{className:"flex flex-wrap justify-between items-center p-4 border-b dark:border-gray-600",children:[e.jsxs("h2",{className:"text-xl font-bold text-sky-800 dark:text-sky-400",children:[e.jsx(A,{iconName:"faClipboardList",className:"mr-2"}),"L·ªãch s·ª≠ ƒë√£ l∆∞u"]}),e.jsxs("div",{className:"flex items-center justify-end  gap-4",children:[s.length>0&&e.jsxs("button",{onClick:a,title:"X√≥a to√†n b·ªô l·ªãch s·ª≠",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:[e.jsx(A,{iconName:"faTrashCan"}),e.jsx("span",{children:"X√≥a t·∫•t c·∫£"})]}),e.jsx("button",{onClick:n,className:"text-gray-600 border border-gray-300 px-3 py-1.5 text-sm font-medium rounded-md hover:text-red-800 dark:text-gray-300 dark:hover:text-white",children:"ƒê√≥ng"})]})]}),e.jsx("main",{className:"p-5 overflow-y-auto",children:s.length>0?e.jsx("ul",{className:"space-y-3",children:s.slice().reverse().map(c=>{var h;return e.jsxs("li",{className:"flex flex-col gap-2 md:flex-row justify-between w-full  items-center p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"w-full md:w-fit flex items-center justify-between px-2 gap-2 md:border-r md:pr-2 mr-4",children:[e.jsx("button",{onClick:()=>t(c),title:"D√πng l·∫°i",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-sky-700 hover:text-sky-900 dark:text-sky-400 dark:hover:text-sky-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:e.jsx(A,{iconName:"faRepeat"})}),e.jsx("button",{onClick:()=>o(c.id),title:"X√≥a m·ª•c n√†y",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:e.jsx(A,{iconName:"faTrashCan"})})]}),e.jsxs("div",{className:"w-full overflow-hidden px-2 mr-4",children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-200 truncate",title:c.inputText,children:c.inputText}),e.jsxs("div",{className:" flex gap-2 text-xs italic text-gray-500 dark:text-gray-400 mt-1",children:[e.jsx("p",{children:"Phong c√°ch : "}),e.jsx("p",{children:((h=c.options)==null?void 0:h.theLoaiGiaoTiep)||"kh√¥ng r√µ"})]})]})]},c.id)})}):e.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Ch∆∞a c√≥ l·ªãch s·ª≠ n√†o ƒë∆∞·ª£c l∆∞u."})})]})})}function ut({text:n,handleErase:t,handleButtonClick:s,isSendDisabled:i,handleHistoryClick:r}){return e.jsxs("div",{className:"flex items-center justify-end gap-2 p-1.5 ",children:[e.jsxs("button",{type:"button",onClick:r,title:"Xem l·ªãch s·ª≠",className:"dark:text-white group flex items-center gap-1 transition-all justify-center rounded border border-gray-300 hover:border-sky-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-sky-900",children:[e.jsx(A,{iconName:"faClipboardList"}),e.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"L·ªãch s·ª≠"})]}),e.jsxs("button",{type:"button",className:`${n.length>0?"opacity-100":"opacity-0 pointer-events-none"} dark:text-white group flex items-center gap-1 transition-all rounded border border-gray-300 hover:border-red-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-red-900`,onClick:t,children:[e.jsx(A,{iconName:"faEraser"}),e.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"X√≥a"})]}),e.jsxs("button",{type:"button",onClick:s,disabled:i,className:`dark:text-white rounded group flex items-center gap-1 border border-gray-300 px-3 py-1.5 text-sm font-medium shadow-sm transition-colors hover:bg-gray-100 ${i?"opacity-50 cursor-not-allowed text-gray-900":"cursor-pointer text-sky-600"}`,children:[e.jsx(A,{iconName:"faPaperPlane"}),e.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"D·ªãch"})]})]})}function gt({text:n,handleChange:t}){return e.jsx("textarea",{id:"Notes",className:"w-full resize-none border-none focus:ring-0 sm:text-sm outline-none h-full px-3 py-2",placeholder:"V√≠ d·ª• : Ti·∫øng nh·∫≠t kh√≥ nh∆∞ng th√∫ v·ªã.",value:n,onChange:t})}function pt({options:n,onOptionChange:t}){const s=i=>{t({...n,theLoaiGiaoTiep:i.target.value})};return e.jsx("div",{className:"w-full p-2",children:e.jsxs("label",{htmlFor:"theLoaiGiaoTiep",className:"cursor-pointer w-full",children:[e.jsx("div",{className:"text-sm font-medium border-b w-full text-gray-700 dark:text-gray-200",children:e.jsx("p",{children:"Th·ªÉ lo·∫°i giao ti·∫øp"})}),e.jsxs("select",{onChange:s,name:"theLoaiGiaoTiep",id:"theLoaiGiaoTiep",value:(n==null?void 0:n.theLoaiGiaoTiep)||"l·ªãch s·ª±",className:"mt-0.5 p-1 w-full rounded-b-xl border border-gray-300 shadow-sm outline-none text-sm dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[e.jsx("option",{value:"l·ªãch s·ª±",children:"L·ªãch s·ª±"}),e.jsx("option",{value:"th√¥ng th∆∞·ªùng",children:"Th√¥ng th∆∞·ªùng"}),e.jsx("option",{value:"su·ªìng s√£",children:"Su·ªìng s√£"}),e.jsx("option",{value:"c·ª•c s√∫c",children:"C·ª•c s√∫c"}),e.jsx("option",{value:"n√≥i v·ªõi c·∫•p tr√™n",children:"N√≥i v·ªõi c·∫•p tr√™n"}),e.jsx("option",{value:"n√≥i v·ªõi c·∫•p d∆∞·ªõi",children:"N√≥i v·ªõi c·∫•p d∆∞·ªõi"}),e.jsx("option",{value:"n√≥i v·ªõi ƒë·ªìng nghi·ªáp",children:"N√≥i v·ªõi ƒë·ªìng nghi·ªáp"})]})]})})}function xt(){const{options:n,inputText:t,setInputText:s,setOptions:i}=l.useContext(U),[r,a]=l.useState(""),[o,c]=l.useState(!1);l.useEffect(()=>{a(t)},[t]),l.useEffect(()=>{const b=y=>{if(!y.ctrlKey)return;const x=y.key.toLowerCase();if(x==="enter"){y.preventDefault(),p();return}if(x==="h"){y.preventDefault(),g();return}if(x==="x"){y.preventDefault(),u();return}};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[r,t]);const h=b=>{a(b.target.value)},p=()=>{r.length>0&&s(r)},u=()=>{window.confirm("Xo√° to√†n b·ªô n·ªôi dung c·ªßa b·∫°n?")&&(a(""),s(""))},g=()=>{c(!o)},I=b=>{window.confirm("B·∫°n c√≥ mu·ªën s·ª≠ d·ª•ng l·∫°i n·ªôi dung n√†y?")&&(s(b.inputText),i(b.options),g())},C=r.length===0||r===t;return e.jsxs("div",{className:"w-full h-full",children:[e.jsxs("label",{htmlFor:"Notes",children:[e.jsxs("div",{className:"flex justify-start items-center gap-2",children:[e.jsx(A,{iconName:"faLanguage",className:"text-2xl text-sky-800"}),e.jsx("span",{className:"text-2xl font-bold",children:"T√¥i mu·ªën n√≥i"})]}),e.jsxs("div",{className:"relative h-full flex flex-col mt-0.5 overflow-hidden rounded-2xl border border-gray-300 shadow-sm focus-within:ring focus-within:ring-green-600 ",children:[e.jsxs("div",{children:[e.jsx(gt,{text:r,handleChange:h}),e.jsx(ut,{text:r,handleErase:u,handleButtonClick:p,isSendDisabled:C,handleHistoryClick:g})]}),e.jsx(pt,{options:n,onOptionChange:i})]})]}),e.jsxs("div",{className:"flex flex-col justify-start",children:[e.jsx("p",{className:"text-xs text-sky-500 mt-1 italic",children:"* N·ªôi dung ƒë∆∞·ª£c d·ªãch b·∫±ng AI"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Ph√≠m t·∫Øt: Ctrl+Enter = D·ªãch ¬∑ Ctrl+H = L·ªãch s·ª≠ ¬∑ Ctrl+X = X√≥a"})]}),o&&e.jsx(ht,{onClose:g,onRepeat:I})]})}const mt=()=>{const{generateContent:n}=ve();return{dichCachDoc:async(s,i)=>{if(i!=null&&i.theLoaiGiaoTiep,!s||typeof s!="string")return{error:"D·ªØ li·ªáu ƒë·∫ßu v√†o kh√¥ng h·ª£p l·ªá"};const r=`
        Role: JLPT Expert.
        Task: Process "${s}".
        Logic:
        1. If input is NOT Japanese, translate it into natural Japanese.
        2. If input IS Japanese, use it directly.
        3. Analyze grammar and vocabulary.
        4. All explanations/meanings must be in VIETNAMESE.

        Output: Minified RAW JSON only (No Markdown, no whitespace).

        Schema:
        {
            "japanese": "Japanese text",
            "romaji": "Romaji",
            "list_vocabulary": [
                {
                    "word": "Word",
                    "meaning": "Vietnamese meaning"
                }
            ],
            "list_structure": [
                {
                    "special_structure": "Grammar Name Vietnamese explanation",
                    "analysis": "Short Vietnamese explanation"
                }
            ]
        }`;try{const a=await n(r);a.startsWith("L·ªói")&&alert("L·ªói : M√°y ch·ªß Google AI ƒëang qu√° t·∫£i. Th·ª≠ l·∫°i sau 1 ph√∫t.");const o=a.match(/\{[\s\S]*\}/);return o?JSON.parse(o[0]):null}catch{return{original:s,japanese:"L·ªói: M√°y ch·ªß Google AI ƒëang b·∫£o tr√¨. Th·ª≠ l·∫°i sau 1-2 ph√∫t. @@",romaji:"",list_vocabulary:[{word:"",meaning:""}],list_structure:[{special_structure:"",analysis:"T.T"}]}}}}},U=l.createContext({options:{},inputText:"",aiCallBack:"",isLoading:!1,error:null,setInputText:()=>{},setOptions:()=>{}});function Lt(){const n=je(),{dichCachDoc:t}=mt(),[s,i]=l.useState(""),[r,a]=l.useState(""),[o,c]=l.useState({theLoaiGiaoTiep:"l·ªãch s·ª±"}),[h,p]=l.useState(!1),[u,g]=l.useState(null);l.useEffect(()=>{window.scrollY&&window.scrollTo({top:0,behavior:"smooth"})},[]);const I=(C,b,y)=>{try{const x=localStorage.getItem("dichHistory")||"[]",T=JSON.parse(x).map(j=>JSON.parse(decodeURIComponent(atob(j))));if(T.some(j=>j.inputText===C&&JSON.stringify(j.options)===JSON.stringify(b))){console.log("M·ª•c gi·ªëng h·ªát ƒë√£ t·ªìn t·∫°i, kh√¥ng l∆∞u.");return}const k={id:Date.now(),inputText:C,options:b,aiCallBack:y},d=T.findLastIndex(j=>j.inputText===C);d!==-1?(console.log(`T√¨m th·∫•y nh√≥m cho '${C}'. Ch√®n v√†o sau v·ªã tr√≠ ${d}.`),T.splice(d+1,0,k)):T.push(k);const f=T.map(j=>{const m=JSON.stringify(j);return btoa(encodeURIComponent(m))});localStorage.setItem("dichHistory",JSON.stringify(f))}catch(x){console.error("L·ªói khi t·ª± ƒë·ªông l∆∞u l·ªãch s·ª≠:",x)}};return l.useEffect(()=>{if(!r){i(""),g(null),p(!1);return}const b=(()=>{try{const x=localStorage.getItem("dichHistory")||"[]",T=JSON.parse(x).find(P=>{const k=JSON.parse(decodeURIComponent(atob(P)));return k.inputText===r&&JSON.stringify(k.options)===JSON.stringify(o)});return T?JSON.parse(decodeURIComponent(atob(T))):null}catch{return null}})();if(b){console.log("T√¨m th·∫•y k·∫øt qu·∫£ trong cache."),i(b.aiCallBack),p(!1),g(null);return}(async()=>{p(!0),g(null);try{const x=await t(r,o);I(r,o,x),i(x)}catch(x){x.response&&x.response.status===429&&alert("B·∫°n ƒë√£ g·ª≠i qu√° nhi·ªÅu y√™u c·∫ßu. Vui l√≤ng th·ª≠ l·∫°i sau m·ªôt l√°t."),g(x),i("")}finally{p(!1)}})()},[r,o]),e.jsx(U.Provider,{value:{options:o,inputText:r,aiCallBack:s,isLoading:h,error:u,setOptions:c,setInputText:a},children:e.jsxs("section",{className:"min-h-screen px-5 mb-5 xl:p-0",children:[e.jsx("div",{className:"mb-5",children:n}),e.jsx(we,{}),e.jsxs("div",{className:"w-full flex flex-col gap-10",children:[e.jsx(xt,{}),e.jsx(dt,{})]})]})})}export{U as DichContext,Lt as default};
