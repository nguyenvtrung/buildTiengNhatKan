import{R as K,j as n,e as ne,g as Re,r as h,I as E,T as we}from"./index-nilSSU1d.js";import{u as Me}from"./index-BNdfWG1K.js";import{A as Ie}from"./index-D8K9Bxtf.js";import{u as Le}from"./Model-BpLrp0aR.js";import{a as Oe,b as Pe,c as Ee,d as Ae,e as De}from"./index-DCbS0Aiy.js";import{G as Be}from"./iconBase-CIDbRZSO.js";import{a as Fe}from"./index-BXMM7deE.js";import{B as ie}from"./ButtonVoidText-D_ITWrtS.js";import{L as ge}from"./index-DoqDGEny.js";import{L as ze}from"./index-CgKrahKA.js";import"./Breadcrumbs-qVsHvHjF.js";function _e(a){return Be({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M319.61 20.654c13.145 33.114 13.144 33.115-5.46 63.5 33.114-13.145 33.116-13.146 63.5 5.457-13.145-33.114-13.146-33.113 5.457-63.498-33.114 13.146-33.113 13.145-63.498-5.459zM113.024 38.021c-11.808 21.04-11.808 21.04-35.724 24.217 21.04 11.809 21.04 11.808 24.217 35.725 11.808-21.04 11.808-21.04 35.724-24.217-21.04-11.808-21.04-11.808-24.217-35.725zm76.55 56.184c-.952 50.588-.95 50.588-41.991 80.18 50.587.95 50.588.95 80.18 41.99.95-50.588.95-50.588 41.99-80.18-50.588-.95-50.588-.95-80.18-41.99zm191.177 55.885c-.046 24.127-.048 24.125-19.377 38.564 24.127.047 24.127.046 38.566 19.375.047-24.126.046-24.125 19.375-38.564-24.126-.047-24.125-.046-38.564-19.375zm-184.086 83.88c-1.191.024-2.36.07-3.492.134-18.591 1.064-41.868 8.416-77.445 22.556L76.012 433.582c78.487-20.734 132.97-21.909 170.99-4.615V247.71c-18.076-8.813-31.79-13.399-46.707-13.737a91.166 91.166 0 0 0-3.629-.002zm122.686 11.42c-2.916-.026-5.81.011-8.514.098-12.81.417-27.638 2.215-45.84 4.522V427.145c43.565-7.825 106.85-4.2 171.244 7.566l-39.78-177.197c-35.904-8.37-56.589-11.91-77.11-12.123zm2.289 16.95c18.889.204 36.852 2.768 53.707 5.02l4.437 16.523c-23.78-3.75-65.966-4.906-92.467-.98l-.636-17.805c11.959-2.154 23.625-2.88 34.959-2.758zm-250.483 4.658l-10.617 46.004h24.094l10.326-46.004H71.158zm345.881 0l39.742 177.031 2.239 9.973 22.591-.152-40.855-186.852h-23.717zm-78.857 57.82c16.993.026 33.67.791 49.146 2.223l3.524 17.174c-32.645-3.08-72.58-2.889-102.995 0l-.709-17.174c16.733-1.533 34.04-2.248 51.034-2.223zm-281.793 6.18l-6.924 30.004h24.394l6.735-30.004H56.389zm274.418 27.244c4.656.021 9.487.085 14.716.203l2.555 17.498c-19.97-.471-47.115.56-59.728 1.05l-.7-17.985c16.803-.493 29.189-.828 43.157-.766zm41.476.447c8.268.042 16.697.334 24.121.069l2.58 17.74c-8.653-.312-24.87-.83-32.064-.502l-2.807-17.234a257.25 257.25 0 0 1 8.17-.073zm-326.97 20.309l-17.985 77.928 25.035-.17 17.455-77.758H45.313zm303.164 11.848c19.608-.01 38.66.774 56.449 2.572l2.996 20.787c-34.305-4.244-85.755-7.697-119.1-3.244l-.14-17.922c20.02-1.379 40.186-2.183 59.795-2.193zm-166.606 44.05c-30.112.09-67.916 6.25-115.408 19.76l-7.22 2.053 187.759-1.27v-6.347c-16.236-9.206-37.42-14.278-65.13-14.196zm134.41 6.174c-19.63.067-37.112 1.439-51.283 4.182v10.064l177.594-1.203c-44.322-8.634-89.137-13.17-126.31-13.043zM26 475v18h460v-18H26z"},child:[]}]})(a)}var le,me;function He(){if(me)return le;me=1;var a={linear:function(e,t,r,i){var s=r-t;return s*e/i+t},easeInQuad:function(e,t,r,i){var s=r-t;return s*(e/=i)*e+t},easeOutQuad:function(e,t,r,i){var s=r-t;return-s*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e+t:-s/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e+t},easeOutCubic:function(e,t,r,i){var s=r-t;return s*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e+t:s/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,r,i){var s=r-t;return-s*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e*e+t:-s/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,r,i){var s=r-t;return s*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e*e*e+t:s/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,r,i){var s=r-t;return-s*Math.cos(e/i*(Math.PI/2))+s+t},easeOutSine:function(e,t,r,i){var s=r-t;return s*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,r,i){var s=r-t;return-s/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,r,i){var s=r-t;return e==0?t:s*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,r,i){var s=r-t;return e==i?t+s:s*(-Math.pow(2,-10*e/i)+1)+t},easeInOutExpo:function(e,t,r,i){var s=r-t;return e===0?t:e===i?t+s:(e/=i/2)<1?s/2*Math.pow(2,10*(e-1))+t:s/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,r,i){var s=r-t;return-s*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,r,i){var s=r-t;return s*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+t:s/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i)===1?t+s:(c||(c=i*.3),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c))+t)},easeOutElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i)===1?t+s:(c||(c=i*.3),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),o*Math.pow(2,-10*e)*Math.sin((e*i-l)*(2*Math.PI)/c)+s+t)},easeInOutElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i/2)===2?t+s:(c||(c=i*(.3*1.5)),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c))+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c)*.5+s+t)},easeInBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),o*(e/=i)*e*((s+1)*e-s)+t},easeOutBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),o*((e=e/i-1)*e*((s+1)*e+s)+1)+t},easeInOutBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),(e/=i/2)<1?o/2*(e*e*(((s*=1.525)+1)*e-s))+t:o/2*((e-=2)*e*(((s*=1.525)+1)*e+s)+2)+t},easeInBounce:function(e,t,r,i){var s=r-t,o;return o=a.easeOutBounce(i-e,0,s,i),s-o+t},easeOutBounce:function(e,t,r,i){var s=r-t;return(e/=i)<1/2.75?s*(7.5625*e*e)+t:e<2/2.75?s*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?s*(7.5625*(e-=2.25/2.75)*e+.9375)+t:s*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,r,i){var s=r-t,o;return e<i/2?(o=a.easeInBounce(e*2,0,s,i),o*.5+t):(o=a.easeOutBounce(e*2-i,0,s,i),o*.5+s*.5+t)}};return le=a,le}var $e=He();function Je(a){return a*Math.PI/180}function I(a,e){return a+Math.random()*(e-a)}function Ge(a,e){return Math.floor(a+Math.random()*(e-a+1))}var Y;(function(a){a[a.Circle=0]="Circle",a[a.Square=1]="Square",a[a.Strip=2]="Strip"})(Y||(Y={}));var $;(function(a){a[a.Positive=1]="Positive",a[a.Negative=-1]="Negative"})($||($={}));const Ve=1e3/60;class We{constructor(e,t,r,i){this.getOptions=t;const{colors:s,initialVelocityX:o,initialVelocityY:c}=this.getOptions();this.context=e,this.x=r,this.y=i,this.w=I(5,20),this.h=I(5,20),this.radius=I(5,10),this.vx=typeof o=="number"?I(-o,o):I(o.min,o.max),this.vy=typeof c=="number"?I(-c,0):I(c.min,c.max),this.shape=Ge(0,2),this.angle=Je(I(0,360)),this.angularSpin=I(-.2,.2),this.color=s[Math.floor(Math.random()*s.length)],this.rotateY=I(0,1),this.rotationDirection=I(0,1)?$.Positive:$.Negative}update(e){const{gravity:t,wind:r,friction:i,opacity:s,drawShape:o}=this.getOptions(),c=e/Ve;this.x+=this.vx*c,this.y+=this.vy*c,this.vy+=t*c,this.vx+=r*c,this.vx*=i**c,this.vy*=i**c,this.rotateY>=1&&this.rotationDirection===$.Positive?this.rotationDirection=$.Negative:this.rotateY<=-1&&this.rotationDirection===$.Negative&&(this.rotationDirection=$.Positive);const l=.1*this.rotationDirection*c;if(this.rotateY+=l,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=s,this.context.lineCap="round",this.context.lineWidth=2,o&&typeof o=="function")o.call(this,this.context);else switch(this.shape){case Y.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case Y.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case Y.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class qe{constructor(e,t){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=i=>{this.particles.splice(i,1)},this.getParticle=()=>{const i=I(this.x,this.w+this.x),s=I(this.y,this.h+this.y);return new We(this.context,this.getOptions,i,s)},this.animate=i=>{const{canvas:s,context:o,particlesGenerated:c,lastNumberOfPieces:l}=this,{run:d,recycle:p,numberOfPieces:g,debug:b,tweenFunction:S,tweenDuration:x}=this.getOptions();if(!d)return!1;const m=this.particles.length,f=p?m:c;if(f<g){l!==g&&(this.tweenProgress=0,this.tweenFrom=f,this.lastNumberOfPieces=g),this.tweenProgress=Math.min(x,Math.max(0,this.tweenProgress+i));const v=S(this.tweenProgress,this.tweenFrom,g,x),w=Math.round(v-f);for(let D=0;D<w;D++)this.particles.push(this.getParticle());this.particlesGenerated+=w}b&&(o.font="12px sans-serif",o.fillStyle="#333",o.textAlign="right",o.fillText(`Particles: ${m}`,s.width-10,s.height-20));for(let v=this.particles.length-1;v>=0;v--){const w=this.particles[v];w.update(i),(w.y>s.height||w.y<-100||w.x>s.width+100||w.x<-100)&&(p&&f<=g?this.particles[v]=this.getParticle():this.removeParticleAt(v))}return m>0||f<g},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=t}}const fe={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:$e.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class Ue{constructor(e,t){this.lastFrameTime=0,this.setOptionsWithDefaults=i=>{const s={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...s,...fe,...i},Object.assign(this,i.confettiSource)},this.update=(i=0)=>{const{options:{run:s,onConfettiComplete:o,frameRate:c},canvas:l,context:d}=this,p=Math.min(i-this.lastFrameTime,50);if(c&&p<1e3/c){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=i-(c?p%c:0),s&&(d.fillStyle="white",d.clearRect(0,0,l.width,l.height)),this.generator.animate(p)?this.rafId=requestAnimationFrame(this.update):(o&&typeof o=="function"&&this.generator.particlesGenerated>0&&o.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new qe(this.canvas,()=>this.options),this.options=t,this.update()}get options(){return this._options}set options(e){var i,s;const t=(i=this._options)==null?void 0:i.run,r=(s=this._options)==null?void 0:s.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&t===!1&&this.update()}}const Xe=K.createRef();class pe extends K.Component{constructor(e){super(e),this.canvas=K.createRef(),this.canvas=e.canvasRef||Xe}componentDidMount(){if(this.canvas.current){const e=he(this.props)[0];this.confetti=new Ue(this.canvas.current,e)}}componentDidUpdate(){const e=he(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,t]=he(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...t.style};return n.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...t,style:r})}}pe.defaultProps={...fe};pe.displayName="ReactConfetti";function he(a){const e={},t={},r={},i=[...Object.keys(fe),"confettiSource","drawShape","onConfettiComplete","frameRate"],s=["canvasRef"];for(const o in a){const c=a[o];i.includes(o)?e[o]=c:s.includes(o)?s[o]=c:r[o]=c}return[e,r,t]}const Qe=K.forwardRef((a,e)=>n.jsx(pe,{canvasRef:e,...a}));function ye(a,e,t,r,i,s,o){try{var c=a[s](o),l=c.value}catch(d){t(d);return}c.done?e(l):Promise.resolve(l).then(r,i)}function V(a){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=a.apply(e,t);function o(l){ye(s,r,i,o,c,"next",l)}function c(l){ye(s,r,i,o,c,"throw",l)}o(void 0)})}}var ue,be;function Ye(){if(be)return ue;be=1;var a="Expected a function",e=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,c=parseInt,l=typeof ne=="object"&&ne&&ne.Object===Object&&ne,d=typeof self=="object"&&self&&self.Object===Object&&self,p=l||d||Function("return this")(),g=Object.prototype,b=g.toString,S=Math.max,x=Math.min,m=function(){return p.Date.now()};function f(u,j,N){var y,T,P,R,k,M,J=0,Z=!1,A=!1,ee=!0;if(typeof u!="function")throw new TypeError(a);j=O(j)||0,v(N)&&(Z=!!N.leading,A="maxWait"in N,P=A?S(O(N.maxWait)||0,j):P,ee="trailing"in N?!!N.trailing:ee);function F(C){var H=y,Q=T;return y=T=void 0,J=C,R=u.apply(Q,H),R}function L(C){return J=C,k=setTimeout(_,j),Z?F(C):R}function G(C){var H=C-M,Q=C-J,xe=j-H;return A?x(xe,P-Q):xe}function z(C){var H=C-M,Q=C-J;return M===void 0||H>=j||H<0||A&&Q>=P}function _(){var C=m();if(z(C))return te(C);k=setTimeout(_,G(C))}function te(C){return k=void 0,ee&&y?F(C):(y=T=void 0,R)}function Te(){k!==void 0&&clearTimeout(k),J=0,y=M=T=k=void 0}function ke(){return k===void 0?R:te(m())}function ce(){var C=m(),H=z(C);if(y=arguments,T=this,M=C,H){if(k===void 0)return L(M);if(A)return k=setTimeout(_,j),F(M)}return k===void 0&&(k=setTimeout(_,j)),R}return ce.cancel=Te,ce.flush=ke,ce}function v(u){var j=typeof u;return!!u&&(j=="object"||j=="function")}function w(u){return!!u&&typeof u=="object"}function D(u){return typeof u=="symbol"||w(u)&&b.call(u)==t}function O(u){if(typeof u=="number")return u;if(D(u))return e;if(v(u)){var j=typeof u.valueOf=="function"?u.valueOf():u;u=v(j)?j+"":j}if(typeof u!="string")return u===0?u:+u;u=u.replace(r,"");var N=s.test(u);return N||o.test(u)?c(u.slice(2),N?2:8):i.test(u)?e:+u}return ue=f,ue}var Ke=Ye();const Ze=Re(Ke),q=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),et=a=>a===q;var re=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const ae=(...a)=>a.map(e=>e.trim()).join(" ").trim(),tt=/\s*\((.*?)\)\s*/g,nt=/(\(\?:[^)]+\))\?/g,st=/(\(\?)?:\w+/g,it=/\*/g,rt=/[-{}[\]+?.,\\^$|#]/g,at=a=>a instanceof RegExp?new RegExp(a.source,"i"):(a=a.replace(rt,"\\$&").replace(tt,"(?:$1)?").replace(st,(e,t)=>t?e:"([^\\s]+)").replace(it,"(.*?)").replace(nt,"\\s*$1?\\s*"),new RegExp("^"+a+"$","i")),ot=(a,e)=>{if(a=a.replace(/\s+/g,"").toLowerCase(),e=e.replace(/\s+/g,"").toLowerCase(),!a.length&&!e.length)return 1;if(!a.length||!e.length)return 0;if(a===e)return 1;if(a.length===1&&e.length===1||a.length<2||e.length<2)return 0;const t=new Map;for(let i=0;i<a.length-1;i++){const s=a.substring(i,i+2),o=t.has(s)?t.get(s)+1:1;t.set(s,o)}let r=0;for(let i=0;i<e.length-1;i++){const s=e.substring(i,i+2),o=t.has(s)?t.get(s):0;o>0&&(t.set(s,o-1),r++)}return 2*r/(a.length+e.length-2)},je=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class de{setSpeechRecognition(e){const t=!!e&&(et(e)||je());t&&(this.disableRecognition(),this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(t)}subscribe(e,t){this.subscribers[e]=t}unsubscribe(e){delete this.subscribers[e]}emitListeningChange(e){this.listening=e,Object.keys(this.subscribers).forEach(t=>{const{onListeningChange:r}=this.subscribers[t];r(e)})}emitMicrophoneAvailabilityChange(e){this.isMicrophoneAvailable=e,Object.keys(this.subscribers).forEach(t=>{const{onMicrophoneAvailabilityChange:r}=this.subscribers[t];r(e)})}emitTranscriptChange(e,t){Object.keys(this.subscribers).forEach(r=>{const{onTranscriptChange:i}=this.subscribers[r];i(e,t)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(e=>{const{onClearTranscript:t}=this.subscribers[e];t()})}emitBrowserSupportsSpeechRecognitionChange(e){Object.keys(this.subscribers).forEach(t=>{const{onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:i}=this.subscribers[t];r(e),i(e)})}disconnect(e){if(this.recognition&&this.listening)switch(e){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(e){e&&e.error&&e.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:e,resultIndex:t}){const r=t===void 0?e.length-1:t;this.interimTranscript="",this.finalTranscript="";for(let s=r;s<e.length;++s)e[s].isFinal&&(!re()||e[s][0].confidence>0)?this.updateFinalTranscript(e[s][0].transcript):this.interimTranscript=ae(this.interimTranscript,e[s][0].transcript);let i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(e){this.finalTranscript=ae(this.finalTranscript,e)}resetTranscript(){this.disconnect("RESET")}startListening(){return V(function*({continuous:e=!1,language:t}={}){if(!this.recognition)return;const r=e!==this.recognition.continuous,i=t&&t!==this.recognition.lang;if((r||i)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=r?e:this.recognition.continuous,this.recognition.lang=i?t:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(s){s instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return V(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}stopListening(){return V(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}getRecognition(){return this.recognition}start(){return V(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(e){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(e),re()&&(this.updateFinalTranscript=Ze(this.updateFinalTranscript,250,{leading:!0}))}}const Ne="CLEAR_TRANSCRIPT",Ce="APPEND_TRANSCRIPT",ct=()=>({type:Ne}),lt=(a,e)=>({type:Ce,payload:{interimTranscript:a,finalTranscript:e}}),ht=(a,e)=>{switch(e.type){case Ne:return{interimTranscript:"",finalTranscript:""};case Ce:return{interimTranscript:e.payload.interimTranscript,finalTranscript:ae(a.finalTranscript,e.payload.finalTranscript)};default:throw new Error}};let U=!!q,se=U&&!re(),B;const ut=({transcribing:a=!0,clearTranscriptOnListen:e=!0,commands:t=[]}={})=>{const[r]=h.useState(W.getRecognitionManager()),[i,s]=h.useState(U),[o,c]=h.useState(se),[{interimTranscript:l,finalTranscript:d},p]=h.useReducer(ht,{interimTranscript:r.interimTranscript,finalTranscript:""}),[g,b]=h.useState(r.listening),[S,x]=h.useState(r.isMicrophoneAvailable),m=h.useRef(t);m.current=t;const f=()=>{p(ct())},v=h.useCallback(()=>{r.resetTranscript(),f()},[r]),w=(y,T,P)=>{const k=(typeof y=="object"?y.toString():y).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),M=ot(k,T);return M>=P?{command:y,commandWithoutSpecials:k,howSimilar:M,isFuzzyMatch:!0}:null},D=(y,T)=>{const R=at(y).exec(T);return R?{command:y,parameters:R.slice(1)}:null},O=h.useCallback((y,T)=>{m.current.forEach(({command:P,callback:R,matchInterim:k=!1,isFuzzyMatch:M=!1,fuzzyMatchingThreshold:J=.8,bestMatchOnly:Z=!1})=>{const A=!T&&k?y.trim():T.trim(),F=(Array.isArray(P)?P:[P]).map(L=>M?w(L,A,J):D(L,A)).filter(L=>L);if(M&&Z&&F.length>=2){F.sort((_,te)=>te.howSimilar-_.howSimilar);const{command:L,commandWithoutSpecials:G,howSimilar:z}=F[0];R(G,A,z,{command:L,resetTranscript:v})}else F.forEach(L=>{if(L.isFuzzyMatch){const{command:G,commandWithoutSpecials:z,howSimilar:_}=L;R(z,A,_,{command:G,resetTranscript:v})}else{const{command:G,parameters:z}=L;R(...z,{command:G,resetTranscript:v})}})})},[v]),u=h.useCallback((y,T)=>{a&&p(lt(y,T)),O(y,T)},[O,a]),j=h.useCallback(()=>{e&&f()},[e]);return h.useEffect(()=>{const y=W.counter;W.counter+=1;const T={onListeningChange:b,onMicrophoneAvailabilityChange:x,onTranscriptChange:u,onClearTranscript:j,onBrowserSupportsSpeechRecognitionChange:s,onBrowserSupportsContinuousListeningChange:c};return r.subscribe(y,T),()=>{r.unsubscribe(y)}},[a,e,r,u,j]),{transcript:ae(d,l),interimTranscript:l,finalTranscript:d,listening:g,isMicrophoneAvailable:S,resetTranscript:v,browserSupportsSpeechRecognition:i,browserSupportsContinuousListening:o}},W={counter:0,applyPolyfill:a=>{B?B.setSpeechRecognition(a):B=new de(a);const e=!!a&&je();U=e,se=e},removePolyfill:()=>{B?B.setSpeechRecognition(q):B=new de(q),U=!!q,se=U&&!re()},getRecognitionManager:()=>(B||(B=new de(q)),B),getRecognition:()=>W.getRecognitionManager().getRecognition(),startListening:({continuous:a,language:e}={})=>V(function*(){yield W.getRecognitionManager().startListening({continuous:a,language:e})})(),stopListening:()=>V(function*(){yield W.getRecognitionManager().stopListening()})(),abortListening:()=>V(function*(){yield W.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>U,browserSupportsContinuousListening:()=>se},dt=/[.,\/#!$%\^&\*;:{}=\-_`~()。、！？\s]/,oe=(a,e)=>{if(!a)return"";let t=a.toLowerCase();return e&&(t=t.replace(/\([^)]*\)|（[^）]*）/g,"")),t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()。、！？]/g,"").replace(/\s+/g,"")},ve=(a,e,t)=>{const r=oe(a,!1),i=oe(e,t);if(!r||!i)return new Set;const s=r.length,o=i.length,c=Array.from(Array(s+1),()=>Array(o+1).fill(0));for(let g=1;g<=s;g++)for(let b=1;b<=o;b++)r[g-1]===i[b-1]?c[g][b]=c[g-1][b-1]+1:c[g][b]=Math.max(c[g-1][b],c[g][b-1]);let l=s,d=o;const p=new Set;for(;l>0&&d>0;)r[l-1]===i[d-1]?(p.add(d-1),l--,d--):c[l-1][d]>c[l][d-1]?l--:d--;return p},gt=(a,e,t)=>{const r=new Set;let i=0,s=!1;for(let o=0;o<e.length;o++){const c=e[o];if(t){if(c==="("||c==="（"){s=!0;continue}if(c===")"||c==="）"){s=!1;continue}if(s)continue}dt.test(c)||(a.has(i)&&r.add(o),i++)}return r},ft=(a,e="ja-JP",t=!0)=>{const[r,i]=h.useState(0),[s,o]=h.useState(new Set),{transcript:c,listening:l,resetTranscript:d,browserSupportsSpeechRecognition:p,isMicrophoneAvailable:g}=ut();return h.useEffect(()=>()=>{},[]),h.useEffect(()=>{if(!c)return;const x=ve(c,a,t),m=gt(x,a,t);o(m)},[c,a,t]),h.useEffect(()=>{if(!l&&c&&a){const x=ve(c,a,t),f=oe(a,t).length;if(f===0){i(0);return}let v=x.size/f*100;oe(c,!1).length>f*1.5&&(v*=.8);const w=v>=90?100:Math.floor(v);i(w)}},[l]),{transcript:c,listening:l,score:r,matchedIndices:s,startRecording:()=>{i(0),o(new Set),d()},stopRecording:()=>{},isSupported:p,hasMic:g}},pt=h.memo(({setStatus:a})=>n.jsx("div",{className:"flex items-center gap-1 cursor-pointer bg-gray-100 text-gray-600 hover:bg-gray-200 p-2 rounded-full transition-all",onClick:()=>a(!1),children:n.jsx(E,{iconName:"faClose"})})),xt=h.memo(({score:a})=>n.jsxs("div",{className:"w-full animate-in fade-in slide-in-from-bottom-2 mt-4",children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Độ chính xác"}),n.jsxs("span",{className:`text-lg font-black ${a>=80?"text-green-600":"text-orange-500"}`,children:[a,"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full transition-all duration-1000 ease-out ${a>=80?"bg-green-500":"bg-orange-500"}`,style:{width:`${a}%`}})})]})),mt=h.memo(({text:a,matchedIndices:e})=>n.jsx("div",{className:"text-xl sm:text-2xl font-medium leading-relaxed flex flex-wrap gap-x-1 text-left",children:a.split("").map((t,r)=>n.jsx("span",{className:`transition-colors duration-200 ${e.has(r)?"text-green-600 font-bold":"text-gray-400"}`,children:t},r))})),yt=({value:a,language:e,setStatus:t})=>{const r=a||"日本語",i=e||"ja-JP",[s,o]=h.useState(!0),{transcript:c,listening:l,score:d,matchedIndices:p,startRecording:g,isSupported:b}=ft(r,i,s);h.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]);const S=f=>{f.cancelable&&f.preventDefault(),g()},x=f=>{f.cancelable&&f.preventDefault()};if(!b)return n.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-[100] bg-black/60 backdrop-blur-sm",children:n.jsxs("div",{className:"bg-white p-6 rounded-2xl shadow-xl max-w-sm text-center",children:[n.jsx("h3",{className:"text-lg font-bold text-red-500 mb-2",children:"Trình duyệt không hỗ trợ"}),n.jsx("p",{className:"text-gray-600 mb-4 text-sm",children:"Vui lòng sử dụng Google Chrome, Edge hoặc Safari."}),n.jsx("button",{onClick:()=>t(!1),className:"bg-gray-200 px-4 py-2 rounded-lg font-bold",children:"Đóng"})]})});const m=!l&&d===100;return n.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[100] p-4 bg-black/60 backdrop-blur-sm",children:[m&&n.jsx("div",{className:"absolute inset-0 z-[200] pointer-events-none",children:n.jsx(Qe,{width:window.innerWidth,height:window.innerHeight,recycle:!1,numberOfPieces:400,gravity:.2})}),n.jsxs("div",{className:"bg-white w-full max-w-lg max-h-[90vh] rounded-[24px] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in duration-300 relative z-10",children:[n.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-100 bg-white z-10",children:[n.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2 uppercase tracking-wide",children:[n.jsx(Oe,{className:"text-blue-500 text-xl"})," Luyện nói"]}),n.jsx(pt,{setStatus:t})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[n.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 border border-gray-100 shadow-sm mb-6",children:[n.jsxs("div",{className:"flex justify-between items-center mb-4",children:[n.jsx("span",{className:"text-[10px] font-black text-blue-800 uppercase tracking-widest bg-blue-50 px-2 py-1 rounded",children:"Nội dung"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ie,{text:r,language:i}),n.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1 px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[s?n.jsx(Pe,{className:"text-green-500"}):n.jsx(Ee,{className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-600",children:"Bỏ ngoặc"})]})]})]}),n.jsx("div",{className:"break-words",children:n.jsx(mt,{text:r,matchedIndices:p})})]}),(c||d>0)&&n.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm animate-in fade-in",children:[n.jsx("p",{className:"text-[10px] text-gray-400 font-bold uppercase mb-1",children:"Kết quả nhận diện"}),n.jsx("p",{className:"text-gray-600 italic text-sm mb-2 break-words min-h-[1.5rem]",children:c?`"${c}"`:"..."}),!l&&d>0&&n.jsx(xt,{score:d})]})]}),n.jsxs("div",{className:"p-4 border-t border-gray-100 bg-white flex flex-col items-center z-10 select-none",children:[n.jsxs("div",{className:"relative flex items-center justify-center",children:[l&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"absolute w-20 h-20 bg-red-500/30 rounded-full animate-radio-wave-slow",style:{animationDelay:"0.5s"}}),n.jsx("div",{className:"absolute w-20 h-20 bg-red-500/50 rounded-full animate-radio-wave-fast"})]}),n.jsx("button",{onMouseDown:S,onMouseUp:x,onMouseLeave:x,onTouchStart:S,onTouchEnd:x,className:`relative z-10 w-20 h-20 rounded-full flex items-center justify-center transition-all duration-100 shadow-xl select-none touch-none ${l?"bg-red-500 shadow-red-200 scale-95 ring-4 ring-red-200":"bg-gradient-to-br from-blue-800 to-blue-600 hover:scale-105 shadow-blue-200"}`,children:n.jsx(Ae,{size:32,className:"text-white"})})]}),n.jsx("p",{className:`mt-3 text-xs font-bold tracking-wide uppercase ${l?"text-red-500 animate-pulse":"text-gray-400"}`,children:l?"Đang thu âm...":"Giữ để nói"})]})]})]})};function Se({value:a,language:e}){const[t,r]=h.useState(!1);return n.jsxs("div",{children:[n.jsx(we,{title:t?"Tắt đọc":"Đọc",className:"cursor-pointer mt-1 p-1 rounded-full shadow shadow-gray-800",onClick:()=>{r(!t)},children:n.jsx(E,{iconName:t?"faMicrophoneLinesSlash":"faMicrophoneLines",className:`${t?"bg-sky-500 text-white":""} transition-all aspect-1/1  text-gray-800 dark:text-white`})}),t&&n.jsx(yt,{value:a,language:e,setStatus:r})]})}const bt=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]}));function vt({title:a}){const{inputText:e,aiCallBack:t,isLoading:r,error:i}=h.useContext(X),{romaji:s,japanese:o}=t||{},c=()=>r?n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}):i?n.jsxs("p",{className:"text-red-500",children:["Lỗi: ",i.message||"Đã có lỗi xảy ra"]}):e?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800",children:"Nội dung:"}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx(ie,{text:e,language:"vi-VN"}),n.jsx("p",{children:e})]})]}),o&&n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800",children:"Dịch:"}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx(ie,{text:o,language:"ja-JP"}),n.jsx(Se,{value:o,language:"ja-JP"}),n.jsx("p",{children:o})]})]}),s&&n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800 italic text-sm",children:"Cách đọc:"}),n.jsx("p",{children:s})]})]}):n.jsx("p",{children:"Vui lòng nhập nội dung cần dịch."});return n.jsxs("div",{className:"w-full shadow shadow-gray-400  rounded-b-2xl p-5 ",children:[n.jsx(bt,{title:a||"Dịch - Cách đọc"}),c()]})}const wt=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),jt=h.memo(({item:a})=>{const{special_structure:e,html:t,analysis:r}=a||{},i=o=>o?o.replace(/Aい/g,"A<sub>い</sub><sub class='text-gray-800 italic'>( Tính từ đuôi い)</sub>").replace(/Aな/g,"A<sub>な</sub><sub class='text-gray-800 italic'>( Tính từ đuôi な)</sub>").replace(/V(る|て|た|ない)/g,"V<sub>$1</sub>").replace("V-masu","V<sub>ます</sub>").replace("N/Na-adj","N<sub class='text-gray-800 italic'>( Danh từ )</sub>").replace(/\*\*(.*?)\*\*/g,"<br><b>$1</b><br>"):"",s=h.useMemo(()=>i(String(e)||""),[e]);return n.jsx(we,{title:`Chi tiết cấu trúc:${e}`||"",placement:"top",arrow:!0,children:n.jsxs("details",{className:"group cursor-pointer p-3 border-b last:border-0 border-gray-100 dark:border-gray-700",children:[n.jsx("summary",{className:"flex items-center justify-between list-none outline-none",children:n.jsx("div",{className:"text-sky-800 dark:text-sky-400 font-bold text-lg hover:text-sky-600 transition-colors",dangerouslySetInnerHTML:{__html:s}})}),n.jsx("div",{className:"grid grid-rows-[0fr] transition-all duration-300 ease-in-out group-open:grid-rows-[1fr]",children:n.jsx("div",{className:"overflow-hidden",children:n.jsx("div",{className:"pt-3 pl-4 border-l-2 border-gray-200 dark:border-gray-600 ml-1 mt-1",children:n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:r})})})})]})})});function Nt({title:a}){const{aiCallBack:e,isLoading:t,error:r}=h.useContext(X),{list_structure:i}=e||{};return n.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[n.jsx(wt,{title:a||"Phân tích"}),t&&n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}),(i==null?void 0:i.length)>0&&!t&&n.jsx("div",{className:"mt-2",children:n.jsx("ul",{className:" list-inside flex  flex-col gap-5",children:i.map((s,o)=>n.jsx("li",{className:"shadow shadow-gray-400 p-2 rounded-2xl",children:n.jsx(jt,{item:s})},o))})}),!t&&(!i||i.length===0)&&n.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Không tìm thấy cấu trúc ngữ pháp đặc biệt."})]})}const Ct=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),St=h.memo(({item:a})=>n.jsxs("li",{className:"w-full h-full shadow shadow-gray-400 p-2 rounded-2xl bg-white dark:bg-gray-900",children:[n.jsxs("div",{className:"flex justify-between items-center gap-2",children:[n.jsxs("div",{className:"flex gap-2 items-center text-xl text-sky-800 dark:text-sky-200",children:[n.jsx(ze,{}),n.jsx("span",{className:"font-Japan font-bold",children:a==null?void 0:a.word})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(ie,{text:a==null?void 0:a.word,language:"ja-JP"}),n.jsx(Se,{value:a==null?void 0:a.word,language:"ja-JP"})]})]}),n.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-xl p-2 mt-2",children:n.jsx("p",{className:"text-sm lg:text-base",children:a==null?void 0:a.meaning})})]}));function Tt({title:a}){const{aiCallBack:e,isLoading:t,error:r}=h.useContext(X),{list_vocabulary:i}=e||{};return n.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[n.jsx(Ct,{title:a||"Phân tích"}),t&&n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}),(i==null?void 0:i.length)>0&&!t&&n.jsx("div",{className:"mt-2",children:n.jsx("ul",{className:" grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-5",children:i.map((s,o)=>{const c=s!=null&&s.word?`${s.word}-${o}`:o;return n.jsx(St,{item:s},c)})})}),!t&&(!i||i.length===0)&&n.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Không tìm thấy từ vựng đặc biệt."})]})}const kt=h.memo(Tt);function Rt({aiCallBack:a}){const[e,t]=K.useState("tab1");h.useEffect(()=>{a&&t("tab1")},[a]);const r=(i,s)=>"dark:text-white flex-1 text-center py-1  px-4 flex items-center justify-center gap-2 text-lg font-medium border-b-4 transition-all duration-300 "+(s===i?"border-indigo-700 text-indigo-800":"border-transparent text-gray-600  hover:text-gray-800 hover:border-gray-300 dark:hover:text-white");return n.jsxs("section",{children:[n.jsxs("nav",{className:"flex justify-between bg-white dark:bg-gray-800  border-b border-gray-200 rounded-t-lg",children:[n.jsxs("button",{onClick:()=>t("tab1"),className:r("tab1",e),children:[n.jsx(De,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Dịch - cách đọc"})]}),n.jsxs("button",{onClick:()=>t("tab2"),className:r("tab2",e),children:[n.jsx(_e,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Phân tích cấu trúc"})]}),n.jsxs("button",{onClick:()=>t("tab3"),className:r("tab3",e),children:[n.jsx(Fe,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Danh sách từ vựng"})]})]}),n.jsxs("div",{className:"",children:[e==="tab1"&&n.jsx(vt,{title:"Dịch"}),e==="tab2"&&n.jsx(Nt,{title:"Cấu trúc"}),e==="tab3"&&n.jsx(kt,{title:"Từ vựng"})]})]})}function Mt(){const{aiCallBack:a,isLoading:e}=h.useContext(X);return n.jsxs("div",{children:[n.jsxs("div",{className:"flex flex-col  md:flex-row justify-between gap-2 items-center",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx(E,{iconName:"faCrown",className:"text-2xl text-yellow-500"}),n.jsx("h1",{className:"text-2xl font-bold",children:"Phân tích"})]}),n.jsx("h5",{className:"text-gray-400 text-sm italic",children:location.href})]}),n.jsx("div",{className:"flex flex-col gap-5 select-text mt-2",children:n.jsx(Rt,{aiCallBack:a})})]})}function It({onClose:a,onRepeat:e}){const[t,r]=h.useState([]),i=()=>{try{const c=localStorage.getItem("dichHistory");if(c){const d=JSON.parse(c).map(p=>{const g=atob(p),b=decodeURIComponent(g);return JSON.parse(b)});r(d)}else r([])}catch(c){console.error("Failed to load history from localStorage:",c),localStorage.removeItem("dichHistory"),r([])}};h.useEffect(()=>{i()},[]);const s=()=>{window.confirm("Bạn có chắc chắn muốn xóa TOÀN BỘ lịch sử dịch? Thao tác này không thể hoàn tác.")&&(localStorage.removeItem("dichHistory"),r([]))},o=c=>{if(window.confirm("Bạn có chắc chắn muốn xóa mục này?")){const l=t.filter(p=>p.id!==c),d=l.map(p=>{const g=JSON.stringify(p);return btoa(encodeURIComponent(g))});localStorage.setItem("dichHistory",JSON.stringify(d)),r(l)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex justify-center items-center",onClick:a,children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-[90%] max-w-2xl max-h-[80vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[n.jsxs("header",{className:"flex flex-wrap justify-between items-center p-4 border-b dark:border-gray-600",children:[n.jsxs("h2",{className:"text-xl font-bold text-sky-800 dark:text-sky-400",children:[n.jsx(E,{iconName:"faClipboardList",className:"mr-2"}),"Lịch sử đã lưu"]}),n.jsxs("div",{className:"flex items-center justify-end  gap-4",children:[t.length>0&&n.jsxs("button",{onClick:s,title:"Xóa toàn bộ lịch sử",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:[n.jsx(E,{iconName:"faTrashCan"}),n.jsx("span",{children:"Xóa tất cả"})]}),n.jsx("button",{onClick:a,className:"text-gray-600 border border-gray-300 px-3 py-1.5 text-sm font-medium rounded-md hover:text-red-800 dark:text-gray-300 dark:hover:text-white",children:"Đóng"})]})]}),n.jsx("main",{className:"p-5 overflow-y-auto",children:t.length>0?n.jsx("ul",{className:"space-y-3",children:t.slice().reverse().map(c=>{var l;return n.jsxs("li",{className:"flex flex-col gap-2 md:flex-row justify-between w-full  items-center p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"w-full md:w-fit flex items-center justify-between px-2 gap-2 md:border-r md:pr-2 mr-4",children:[n.jsx("button",{onClick:()=>e(c),title:"Dùng lại",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-sky-700 hover:text-sky-900 dark:text-sky-400 dark:hover:text-sky-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:n.jsx(E,{iconName:"faRepeat"})}),n.jsx("button",{onClick:()=>o(c.id),title:"Xóa mục này",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:n.jsx(E,{iconName:"faTrashCan"})})]}),n.jsxs("div",{className:"w-full overflow-hidden px-2 mr-4",children:[n.jsx("p",{className:"text-gray-800 dark:text-gray-200 truncate",title:c.inputText,children:c.inputText}),n.jsxs("div",{className:" flex gap-2 text-xs italic text-gray-500 dark:text-gray-400 mt-1",children:[n.jsx("p",{children:"Phong cách : "}),n.jsx("p",{children:((l=c.options)==null?void 0:l.theLoaiGiaoTiep)||"không rõ"})]})]})]},c.id)})}):n.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Chưa có lịch sử nào được lưu."})})]})})}function Lt({text:a,handleErase:e,handleButtonClick:t,isSendDisabled:r,handleHistoryClick:i}){return n.jsxs("div",{className:"flex items-center justify-end gap-2 p-1.5 ",children:[n.jsxs("button",{type:"button",onClick:i,title:"Xem lịch sử",className:"dark:text-white group flex items-center gap-1 transition-all justify-center rounded border border-gray-300 hover:border-sky-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-sky-900",children:[n.jsx(E,{iconName:"faClipboardList"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Lịch sử"})]}),n.jsxs("button",{type:"button",className:`${a.length>0?"opacity-100":"opacity-0 pointer-events-none"} dark:text-white group flex items-center gap-1 transition-all rounded border border-gray-300 hover:border-red-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-red-900`,onClick:e,children:[n.jsx(E,{iconName:"faEraser"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Xóa"})]}),n.jsxs("button",{type:"button",onClick:t,disabled:r,className:`dark:text-white rounded group flex items-center gap-1 border border-gray-300 px-3 py-1.5 text-sm font-medium shadow-sm transition-colors hover:bg-gray-100 ${r?"opacity-50 cursor-not-allowed text-gray-900":"cursor-pointer text-sky-600"}`,children:[n.jsx(E,{iconName:"faPaperPlane"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Dịch"})]})]})}function Ot({text:a,handleChange:e}){return n.jsx("textarea",{id:"Notes",className:"w-full resize-none border-none focus:ring-0 sm:text-sm outline-none h-full px-3 py-2",placeholder:"Ví dụ : Tiếng nhật khó nhưng thú vị.",value:a,onChange:e})}function Pt({options:a,onOptionChange:e}){const t=r=>{e({...a,theLoaiGiaoTiep:r.target.value})};return n.jsx("div",{className:"w-full p-2",children:n.jsxs("label",{htmlFor:"theLoaiGiaoTiep",className:"cursor-pointer w-full",children:[n.jsx("div",{className:"text-sm font-medium border-b w-full text-gray-700 dark:text-gray-200",children:n.jsx("p",{children:"Thể loại giao tiếp"})}),n.jsxs("select",{onChange:t,name:"theLoaiGiaoTiep",id:"theLoaiGiaoTiep",value:(a==null?void 0:a.theLoaiGiaoTiep)||"lịch sự",className:"mt-0.5 p-1 w-full rounded-b-xl border border-gray-300 shadow-sm outline-none text-sm dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[n.jsx("option",{value:"lịch sự",children:"Lịch sự"}),n.jsx("option",{value:"thông thường",children:"Thông thường"}),n.jsx("option",{value:"suồng sã",children:"Suồng sã"}),n.jsx("option",{value:"cục súc",children:"Cục súc"}),n.jsx("option",{value:"nói với cấp trên",children:"Nói với cấp trên"}),n.jsx("option",{value:"nói với cấp dưới",children:"Nói với cấp dưới"}),n.jsx("option",{value:"nói với đồng nghiệp",children:"Nói với đồng nghiệp"})]})]})})}function Et(){const{options:a,inputText:e,setInputText:t,setOptions:r}=h.useContext(X),[i,s]=h.useState(""),[o,c]=h.useState(!1);h.useEffect(()=>{s(e)},[e]),h.useEffect(()=>{const x=m=>{if(!m.ctrlKey)return;const f=m.key.toLowerCase();if(f==="enter"){m.preventDefault(),d();return}if(f==="h"){m.preventDefault(),g();return}if(f==="x"){m.preventDefault(),p();return}};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[i,e]);const l=x=>{s(x.target.value)},d=()=>{i.length>0&&t(i)},p=()=>{window.confirm("Xoá toàn bộ nội dung của bạn?")&&(s(""),t(""))},g=()=>{c(!o)},b=x=>{window.confirm("Bạn có muốn sử dụng lại nội dung này?")&&(t(x.inputText),r(x.options),g())},S=i.length===0||i===e;return n.jsxs("div",{className:"w-full h-full",children:[n.jsxs("label",{htmlFor:"Notes",children:[n.jsxs("div",{className:"flex justify-start items-center gap-2",children:[n.jsx(E,{iconName:"faLanguage",className:"text-2xl text-sky-800"}),n.jsx("span",{className:"text-2xl font-bold",children:"Tôi muốn nói"})]}),n.jsxs("div",{className:"relative h-full flex flex-col mt-0.5 overflow-hidden rounded-2xl border border-gray-300 shadow-sm focus-within:ring focus-within:ring-green-600 ",children:[n.jsxs("div",{children:[n.jsx(Ot,{text:i,handleChange:l}),n.jsx(Lt,{text:i,handleErase:p,handleButtonClick:d,isSendDisabled:S,handleHistoryClick:g})]}),n.jsx(Pt,{options:a,onOptionChange:r})]})]}),n.jsxs("div",{className:"flex flex-col justify-start",children:[n.jsx("p",{className:"text-xs text-sky-500 mt-1 italic",children:"* Nội dung được dịch bằng AI"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Phím tắt: Ctrl+Enter = Dịch · Ctrl+H = Lịch sử · Ctrl+X = Xóa"})]}),o&&n.jsx(It,{onClose:g,onRepeat:b})]})}const At=()=>{const{generateContent:a}=Le();return{dichCachDoc:async(t,r)=>{if(r!=null&&r.theLoaiGiaoTiep,!t||typeof t!="string")return{error:"Dữ liệu đầu vào không hợp lệ"};const i=`
        Role: JLPT Expert.
        Task: Process "${t}".
        Logic:
        1. If input is NOT Japanese, translate it into natural Japanese.
        2. If input IS Japanese, use it directly.
        3. Analyze grammar and vocabulary.
        4. All explanations/meanings must be in VIETNAMESE.

        Output: Minified RAW JSON only (No Markdown, no whitespace).

        Schema:
        {
            "japanese": "Japanese text",
            "romaji": "Romaji",
            "list_vocabulary": [
                {
                    "word": "Word",
                    "meaning": "Vietnamese meaning"
                }
            ],
            "list_structure": [
                {
                    "special_structure": "Grammar Name Vietnamese explanation",
                    "analysis": "Short Vietnamese explanation"
                }
            ]
        }`;try{const s=await a(i);s.startsWith("Lỗi")&&alert("Lỗi : Máy chủ Google AI đang quá tải. Thử lại sau 1 phút.");const o=s.match(/\{[\s\S]*\}/);return o?JSON.parse(o[0]):null}catch{return{original:t,japanese:"Lỗi: Máy chủ Google AI đang bảo trì. Thử lại sau 1-2 phút. @@",romaji:"",list_vocabulary:[{word:"",meaning:""}],list_structure:[{special_structure:"",analysis:"T.T"}]}}}}},X=h.createContext({options:{},inputText:"",aiCallBack:"",isLoading:!1,error:null,setInputText:()=>{},setOptions:()=>{}});function qt(){const a=Me(),{dichCachDoc:e}=At(),[t,r]=h.useState(""),[i,s]=h.useState(""),[o,c]=h.useState({theLoaiGiaoTiep:"lịch sự"}),[l,d]=h.useState(!1),[p,g]=h.useState(null);h.useEffect(()=>{window.scrollY&&window.scrollTo({top:0,behavior:"smooth"})},[]);const b=(S,x,m)=>{try{const f=localStorage.getItem("dichHistory")||"[]",w=JSON.parse(f).map(N=>JSON.parse(decodeURIComponent(atob(N))));if(w.some(N=>N.inputText===S&&JSON.stringify(N.options)===JSON.stringify(x))){console.log("Mục giống hệt đã tồn tại, không lưu.");return}const O={id:Date.now(),inputText:S,options:x,aiCallBack:m},u=w.findLastIndex(N=>N.inputText===S);u!==-1?(console.log(`Tìm thấy nhóm cho '${S}'. Chèn vào sau vị trí ${u}.`),w.splice(u+1,0,O)):w.push(O);const j=w.map(N=>{const y=JSON.stringify(N);return btoa(encodeURIComponent(y))});localStorage.setItem("dichHistory",JSON.stringify(j))}catch(f){console.error("Lỗi khi tự động lưu lịch sử:",f)}};return h.useEffect(()=>{if(!i){r(""),g(null),d(!1);return}const x=(()=>{try{const f=localStorage.getItem("dichHistory")||"[]",w=JSON.parse(f).find(D=>{const O=JSON.parse(decodeURIComponent(atob(D)));return O.inputText===i&&JSON.stringify(O.options)===JSON.stringify(o)});return w?JSON.parse(decodeURIComponent(atob(w))):null}catch{return null}})();if(x){console.log("Tìm thấy kết quả trong cache."),r(x.aiCallBack),d(!1),g(null);return}(async()=>{d(!0),g(null);try{const f=await e(i,o);b(i,o,f),r(f)}catch(f){f.response&&f.response.status===429&&alert("Bạn đã gửi quá nhiều yêu cầu. Vui lòng thử lại sau một lát."),g(f),r("")}finally{d(!1)}})()},[i,o]),n.jsx(X.Provider,{value:{options:o,inputText:i,aiCallBack:t,isLoading:l,error:p,setOptions:c,setInputText:s},children:n.jsxs("section",{className:"min-h-screen px-5 mb-5 xl:p-0",children:[n.jsx("div",{className:"mb-5",children:a}),n.jsx(Ie,{}),n.jsxs("div",{className:"w-full flex flex-col gap-10",children:[n.jsx(Et,{}),n.jsx(Mt,{})]})]})})}export{X as DichContext,qt as default};
