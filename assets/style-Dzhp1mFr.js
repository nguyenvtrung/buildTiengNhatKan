import{r as d,R as x,j as s,I as K}from"./index-C4nicHr7.js";const V=w=>{if(!w)return null;const X="bottom",[m,O]=d.useState({}),[B,_]=d.useState({}),[y,T]=d.useState(!1),p=d.useRef([]),b=d.useRef([]),R=d.useRef([]),z=/([\u4e00-\u9faf]+|\d+)\s*[（(](.*?)[）)]/g,E=String(w).match(/<truvndich>(.*?)<\/truvndich>/),I=String(w).replace(/<truvndich>(.*?)<\/truvndich>/,""),v=[...I.matchAll(z)];p.current.length!==v.length&&(p.current=v.map((n,t)=>p.current[t]??x.createRef()),b.current=v.map((n,t)=>b.current[t]??x.createRef()),R.current=v.map((n,t)=>R.current[t]??x.createRef()));const S=n=>{O(t=>({...t,[n]:!t[n]}))};d.useEffect(()=>{(()=>{var g,r;const t={},f=Object.keys(m).filter(e=>m[e]).map(Number).sort((e,i)=>{var c,l,h,u;const o=(l=(c=b.current[e])==null?void 0:c.current)==null?void 0:l.getBoundingClientRect(),a=(u=(h=b.current[i])==null?void 0:h.current)==null?void 0:u.getBoundingClientRect();return((o==null?void 0:o.left)||0)-((a==null?void 0:a.left)||0)});f.forEach(e=>t[e]=0);for(let e=0;e<f.length;e++){const i=f[e],o=(g=p.current[i])==null?void 0:g.current;if(!o)continue;let a=o.getBoundingClientRect();for(let c=0;c<e;c++){const l=f[c],h=(r=p.current[l])==null?void 0:r.current;if(!h)continue;const u=h.getBoundingClientRect();a.left<u.right&&a.right>u.left&&(t[i]=(t[l]||0)+u.height+5,t[i])}}_(t)})()},[m]),d.useEffect(()=>{v.forEach((n,t)=>{var e,i,o;const f=(e=p.current[t])==null?void 0:e.current,g=(i=b.current[t])==null?void 0:i.current,r=(o=R.current[t])==null?void 0:o.current;if(f&&g&&r&&m[t]){const a=f.getBoundingClientRect(),c=g.getBoundingClientRect(),l=g.parentElement.getBoundingClientRect(),h=(a.left+a.right)/2,u=(c.left+c.right)/2;let C,$;C=a.bottom,$=c.top;const N=Math.abs($-C),D=Math.abs(h-u)+10,M=Math.min(h,u)-l.left-5;{const H=l.bottom-c.top;r.style.bottom=`${H}px`,r.style.top="auto"}const F=h-(M+l.left),A=u-(M+l.left);let P="";P=`M${F} 0 V${N} H${A}`,r.setAttribute("width",D),r.setAttribute("height",N),r.style.left=`${M+3.5}px`,r.innerHTML=`<path d="${P}" stroke="#b91c1c" stroke-width="1.5" fill="none" />`}})},[m,B]);let k=0;const j=[];return v.forEach((n,t)=>{const f=n[0],g=n[1],r=n[2],e=n.index,i=B[t]||0,o=I.substring(k,e);o&&j.push(s.jsx(x.Fragment,{children:o},`pre-${t}`)),j.push(s.jsxs("span",{style:{position:"relative",display:"inline-block"},children:[s.jsx("span",{ref:b.current[t],onMouseEnter:()=>S(t),onMouseLeave:()=>S(t),style:{cursor:"pointer",borderBottom:"1px dotted #234212"},className:"transition-all hover:text-red-800 hover:bg-amber-50/90 hover:shadow hover:shadow-amber-800/50 hover:rounded-sm hover:px-1",children:g}),m[t]&&s.jsxs(s.Fragment,{children:[s.jsx("span",{ref:p.current[t],className:"text-sm text-red-800 bg-amber-50/90 shadow shadow-amber-800/50 rounded-sm px-1",style:{position:"absolute",[X]:`calc(100% + ${i+5}px)`,left:"50%",transform:"translateX(-50%)",whiteSpace:"nowrap",zIndex:10},children:r}),s.jsx("svg",{ref:R.current[t],style:{position:"absolute",zIndex:9,overflow:"visible",pointerEvents:"none"}})]})]},`container-${t}`)),k=e+f.length}),j.push(s.jsx(x.Fragment,{children:I.substring(k)},"remaining")),s.jsxs("div",{className:"relative flex flex-col",children:[s.jsx("div",{className:"pr-6",children:j}),E&&s.jsx("div",{className:"z-20 cursor-pointer hover:bg-indigo-400 hover:text-white text-[9px] text-indigo-800 font-bold absolute px-2 py-1 rounded-full bg-white border border-indigo-800 top-1/2 -translate-y-1/2 right-0 translate-x-1/2 transition-all",onClick:n=>{n.stopPropagation(),T(!y)},children:y?s.jsx(K,{iconName:"faClose"}):"Dịch"}),y&&E&&s.jsx("p",{className:"z-10 absolute top-1/2 text-xs h-full w-full overflow-y-auto -translate-y-1/2 left-0 text-white bg-gray-600 px-2 rounded-md italic",children:E[1]})]})};export{V as f};
