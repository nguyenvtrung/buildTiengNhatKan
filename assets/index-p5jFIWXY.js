import{R as Z,j as n,e as se,g as Re,r as h,I as A,T as we}from"./index-C05eWJr7.js";import{u as Me}from"./index-BMLPzEE7.js";import{A as Ie}from"./index-BLamktAw.js";import{u as Le}from"./Model-CrjMDQPQ.js";import{a as Oe,b as Pe,c as Ee,d as Ae,e as De}from"./index-BJNeCJf0.js";import{G as Be}from"./iconBase-O0SZJS1W.js";import{a as Fe}from"./index-DjqT48vu.js";import{B as re}from"./ButtonVoidText-zJfs2MxN.js";import{L as ge}from"./index-DRbwucHE.js";import{L as ze}from"./index-Da7zjAfq.js";import"./Breadcrumbs-BnMafoeV.js";function He(a){return Be({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M319.61 20.654c13.145 33.114 13.144 33.115-5.46 63.5 33.114-13.145 33.116-13.146 63.5 5.457-13.145-33.114-13.146-33.113 5.457-63.498-33.114 13.146-33.113 13.145-63.498-5.459zM113.024 38.021c-11.808 21.04-11.808 21.04-35.724 24.217 21.04 11.809 21.04 11.808 24.217 35.725 11.808-21.04 11.808-21.04 35.724-24.217-21.04-11.808-21.04-11.808-24.217-35.725zm76.55 56.184c-.952 50.588-.95 50.588-41.991 80.18 50.587.95 50.588.95 80.18 41.99.95-50.588.95-50.588 41.99-80.18-50.588-.95-50.588-.95-80.18-41.99zm191.177 55.885c-.046 24.127-.048 24.125-19.377 38.564 24.127.047 24.127.046 38.566 19.375.047-24.126.046-24.125 19.375-38.564-24.126-.047-24.125-.046-38.564-19.375zm-184.086 83.88c-1.191.024-2.36.07-3.492.134-18.591 1.064-41.868 8.416-77.445 22.556L76.012 433.582c78.487-20.734 132.97-21.909 170.99-4.615V247.71c-18.076-8.813-31.79-13.399-46.707-13.737a91.166 91.166 0 0 0-3.629-.002zm122.686 11.42c-2.916-.026-5.81.011-8.514.098-12.81.417-27.638 2.215-45.84 4.522V427.145c43.565-7.825 106.85-4.2 171.244 7.566l-39.78-177.197c-35.904-8.37-56.589-11.91-77.11-12.123zm2.289 16.95c18.889.204 36.852 2.768 53.707 5.02l4.437 16.523c-23.78-3.75-65.966-4.906-92.467-.98l-.636-17.805c11.959-2.154 23.625-2.88 34.959-2.758zm-250.483 4.658l-10.617 46.004h24.094l10.326-46.004H71.158zm345.881 0l39.742 177.031 2.239 9.973 22.591-.152-40.855-186.852h-23.717zm-78.857 57.82c16.993.026 33.67.791 49.146 2.223l3.524 17.174c-32.645-3.08-72.58-2.889-102.995 0l-.709-17.174c16.733-1.533 34.04-2.248 51.034-2.223zm-281.793 6.18l-6.924 30.004h24.394l6.735-30.004H56.389zm274.418 27.244c4.656.021 9.487.085 14.716.203l2.555 17.498c-19.97-.471-47.115.56-59.728 1.05l-.7-17.985c16.803-.493 29.189-.828 43.157-.766zm41.476.447c8.268.042 16.697.334 24.121.069l2.58 17.74c-8.653-.312-24.87-.83-32.064-.502l-2.807-17.234a257.25 257.25 0 0 1 8.17-.073zm-326.97 20.309l-17.985 77.928 25.035-.17 17.455-77.758H45.313zm303.164 11.848c19.608-.01 38.66.774 56.449 2.572l2.996 20.787c-34.305-4.244-85.755-7.697-119.1-3.244l-.14-17.922c20.02-1.379 40.186-2.183 59.795-2.193zm-166.606 44.05c-30.112.09-67.916 6.25-115.408 19.76l-7.22 2.053 187.759-1.27v-6.347c-16.236-9.206-37.42-14.278-65.13-14.196zm134.41 6.174c-19.63.067-37.112 1.439-51.283 4.182v10.064l177.594-1.203c-44.322-8.634-89.137-13.17-126.31-13.043zM26 475v18h460v-18H26z"},child:[]}]})(a)}var le,me;function _e(){if(me)return le;me=1;var a={linear:function(e,t,r,i){var s=r-t;return s*e/i+t},easeInQuad:function(e,t,r,i){var s=r-t;return s*(e/=i)*e+t},easeOutQuad:function(e,t,r,i){var s=r-t;return-s*(e/=i)*(e-2)+t},easeInOutQuad:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e+t:-s/2*(--e*(e-2)-1)+t},easeInCubic:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e+t},easeOutCubic:function(e,t,r,i){var s=r-t;return s*((e=e/i-1)*e*e+1)+t},easeInOutCubic:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e+t:s/2*((e-=2)*e*e+2)+t},easeInQuart:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e*e+t},easeOutQuart:function(e,t,r,i){var s=r-t;return-s*((e=e/i-1)*e*e*e-1)+t},easeInOutQuart:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e*e+t:-s/2*((e-=2)*e*e*e-2)+t},easeInQuint:function(e,t,r,i){var s=r-t;return s*(e/=i)*e*e*e*e+t},easeOutQuint:function(e,t,r,i){var s=r-t;return s*((e=e/i-1)*e*e*e*e+1)+t},easeInOutQuint:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?s/2*e*e*e*e*e+t:s/2*((e-=2)*e*e*e*e+2)+t},easeInSine:function(e,t,r,i){var s=r-t;return-s*Math.cos(e/i*(Math.PI/2))+s+t},easeOutSine:function(e,t,r,i){var s=r-t;return s*Math.sin(e/i*(Math.PI/2))+t},easeInOutSine:function(e,t,r,i){var s=r-t;return-s/2*(Math.cos(Math.PI*e/i)-1)+t},easeInExpo:function(e,t,r,i){var s=r-t;return e==0?t:s*Math.pow(2,10*(e/i-1))+t},easeOutExpo:function(e,t,r,i){var s=r-t;return e==i?t+s:s*(-Math.pow(2,-10*e/i)+1)+t},easeInOutExpo:function(e,t,r,i){var s=r-t;return e===0?t:e===i?t+s:(e/=i/2)<1?s/2*Math.pow(2,10*(e-1))+t:s/2*(-Math.pow(2,-10*--e)+2)+t},easeInCirc:function(e,t,r,i){var s=r-t;return-s*(Math.sqrt(1-(e/=i)*e)-1)+t},easeOutCirc:function(e,t,r,i){var s=r-t;return s*Math.sqrt(1-(e=e/i-1)*e)+t},easeInOutCirc:function(e,t,r,i){var s=r-t;return(e/=i/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+t:s/2*(Math.sqrt(1-(e-=2)*e)+1)+t},easeInElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i)===1?t+s:(c||(c=i*.3),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c))+t)},easeOutElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i)===1?t+s:(c||(c=i*.3),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),o*Math.pow(2,-10*e)*Math.sin((e*i-l)*(2*Math.PI)/c)+s+t)},easeInOutElastic:function(e,t,r,i){var s=r-t,o,c,l;return l=1.70158,c=0,o=s,e===0?t:(e/=i/2)===2?t+s:(c||(c=i*(.3*1.5)),o<Math.abs(s)?(o=s,l=c/4):l=c/(2*Math.PI)*Math.asin(s/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c))+t:o*Math.pow(2,-10*(e-=1))*Math.sin((e*i-l)*(2*Math.PI)/c)*.5+s+t)},easeInBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),o*(e/=i)*e*((s+1)*e-s)+t},easeOutBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),o*((e=e/i-1)*e*((s+1)*e+s)+1)+t},easeInOutBack:function(e,t,r,i,s){var o=r-t;return s===void 0&&(s=1.70158),(e/=i/2)<1?o/2*(e*e*(((s*=1.525)+1)*e-s))+t:o/2*((e-=2)*e*(((s*=1.525)+1)*e+s)+2)+t},easeInBounce:function(e,t,r,i){var s=r-t,o;return o=a.easeOutBounce(i-e,0,s,i),s-o+t},easeOutBounce:function(e,t,r,i){var s=r-t;return(e/=i)<1/2.75?s*(7.5625*e*e)+t:e<2/2.75?s*(7.5625*(e-=1.5/2.75)*e+.75)+t:e<2.5/2.75?s*(7.5625*(e-=2.25/2.75)*e+.9375)+t:s*(7.5625*(e-=2.625/2.75)*e+.984375)+t},easeInOutBounce:function(e,t,r,i){var s=r-t,o;return e<i/2?(o=a.easeInBounce(e*2,0,s,i),o*.5+t):(o=a.easeOutBounce(e*2-i,0,s,i),o*.5+s*.5+t)}};return le=a,le}var $e=_e();function Ge(a){return a*Math.PI/180}function L(a,e){return a+Math.random()*(e-a)}function Je(a,e){return Math.floor(a+Math.random()*(e-a+1))}var Y;(function(a){a[a.Circle=0]="Circle",a[a.Square=1]="Square",a[a.Strip=2]="Strip"})(Y||(Y={}));var $;(function(a){a[a.Positive=1]="Positive",a[a.Negative=-1]="Negative"})($||($={}));const Ve=1e3/60;class We{constructor(e,t,r,i){this.getOptions=t;const{colors:s,initialVelocityX:o,initialVelocityY:c}=this.getOptions();this.context=e,this.x=r,this.y=i,this.w=L(5,20),this.h=L(5,20),this.radius=L(5,10),this.vx=typeof o=="number"?L(-o,o):L(o.min,o.max),this.vy=typeof c=="number"?L(-c,0):L(c.min,c.max),this.shape=Je(0,2),this.angle=Ge(L(0,360)),this.angularSpin=L(-.2,.2),this.color=s[Math.floor(Math.random()*s.length)],this.rotateY=L(0,1),this.rotationDirection=L(0,1)?$.Positive:$.Negative}update(e){const{gravity:t,wind:r,friction:i,opacity:s,drawShape:o}=this.getOptions(),c=e/Ve;this.x+=this.vx*c,this.y+=this.vy*c,this.vy+=t*c,this.vx+=r*c,this.vx*=i**c,this.vy*=i**c,this.rotateY>=1&&this.rotationDirection===$.Positive?this.rotationDirection=$.Negative:this.rotateY<=-1&&this.rotationDirection===$.Negative&&(this.rotationDirection=$.Positive);const l=.1*this.rotationDirection*c;if(this.rotateY+=l,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=s,this.context.lineCap="round",this.context.lineWidth=2,o&&typeof o=="function")o.call(this,this.context);else switch(this.shape){case Y.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case Y.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case Y.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class qe{constructor(e,t){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=i=>{this.particles.splice(i,1)},this.getParticle=()=>{const i=L(this.x,this.w+this.x),s=L(this.y,this.h+this.y);return new We(this.context,this.getOptions,i,s)},this.animate=i=>{const{canvas:s,context:o,particlesGenerated:c,lastNumberOfPieces:l}=this,{run:g,recycle:p,numberOfPieces:u,debug:b,tweenFunction:k,tweenDuration:w}=this.getOptions();if(!g)return!1;const m=this.particles.length,f=p?m:c;if(f<u){l!==u&&(this.tweenProgress=0,this.tweenFrom=f,this.lastNumberOfPieces=u),this.tweenProgress=Math.min(w,Math.max(0,this.tweenProgress+i));const x=k(this.tweenProgress,this.tweenFrom,u,w),y=Math.round(x-f);for(let j=0;j<y;j++)this.particles.push(this.getParticle());this.particlesGenerated+=y}b&&(o.font="12px sans-serif",o.fillStyle="#333",o.textAlign="right",o.fillText(`Particles: ${m}`,s.width-10,s.height-20));for(let x=this.particles.length-1;x>=0;x--){const y=this.particles[x];y.update(i),(y.y>s.height||y.y<-100||y.x>s.width+100||y.x<-100)&&(p&&f<=u?this.particles[x]=this.getParticle():this.removeParticleAt(x))}return m>0||f<u},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=t}}const fe={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:$e.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class Ue{constructor(e,t){this.lastFrameTime=0,this.setOptionsWithDefaults=i=>{const s={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...s,...fe,...i},Object.assign(this,i.confettiSource)},this.update=(i=0)=>{const{options:{run:s,onConfettiComplete:o,frameRate:c},canvas:l,context:g}=this,p=Math.min(i-this.lastFrameTime,50);if(c&&p<1e3/c){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=i-(c?p%c:0),s&&(g.fillStyle="white",g.clearRect(0,0,l.width,l.height)),this.generator.animate(p)?this.rafId=requestAnimationFrame(this.update):(o&&typeof o=="function"&&this.generator.particlesGenerated>0&&o.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new qe(this.canvas,()=>this.options),this.options=t,this.update()}get options(){return this._options}set options(e){var i,s;const t=(i=this._options)==null?void 0:i.run,r=(s=this._options)==null?void 0:s.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&t===!1&&this.update()}}const Xe=Z.createRef();class pe extends Z.Component{constructor(e){super(e),this.canvas=Z.createRef(),this.canvas=e.canvasRef||Xe}componentDidMount(){if(this.canvas.current){const e=he(this.props)[0];this.confetti=new Ue(this.canvas.current,e)}}componentDidUpdate(){const e=he(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,t]=he(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...t.style};return n.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...t,style:r})}}pe.defaultProps={...fe};pe.displayName="ReactConfetti";function he(a){const e={},t={},r={},i=[...Object.keys(fe),"confettiSource","drawShape","onConfettiComplete","frameRate"],s=["canvasRef"];for(const o in a){const c=a[o];i.includes(o)?e[o]=c:s.includes(o)?s[o]=c:r[o]=c}return[e,r,t]}const Qe=Z.forwardRef((a,e)=>n.jsx(pe,{canvasRef:e,...a}));function ye(a,e,t,r,i,s,o){try{var c=a[s](o),l=c.value}catch(g){t(g);return}c.done?e(l):Promise.resolve(l).then(r,i)}function V(a){return function(){var e=this,t=arguments;return new Promise(function(r,i){var s=a.apply(e,t);function o(l){ye(s,r,i,o,c,"next",l)}function c(l){ye(s,r,i,o,c,"throw",l)}o(void 0)})}}var ue,be;function Ye(){if(be)return ue;be=1;var a="Expected a function",e=NaN,t="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,o=/^0o[0-7]+$/i,c=parseInt,l=typeof se=="object"&&se&&se.Object===Object&&se,g=typeof self=="object"&&self&&self.Object===Object&&self,p=l||g||Function("return this")(),u=Object.prototype,b=u.toString,k=Math.max,w=Math.min,m=function(){return p.Date.now()};function f(d,N,C){var v,T,E,M,R,I,G=0,ee=!1,D=!1,te=!0;if(typeof d!="function")throw new TypeError(a);N=P(N)||0,x(C)&&(ee=!!C.leading,D="maxWait"in C,E=D?k(P(C.maxWait)||0,N):E,te="trailing"in C?!!C.trailing:te);function F(S){var _=v,Q=T;return v=T=void 0,G=S,M=d.apply(Q,_),M}function O(S){return G=S,R=setTimeout(H,N),ee?F(S):M}function J(S){var _=S-I,Q=S-G,xe=N-_;return D?w(xe,E-Q):xe}function z(S){var _=S-I,Q=S-G;return I===void 0||_>=N||_<0||D&&Q>=E}function H(){var S=m();if(z(S))return ne(S);R=setTimeout(H,J(S))}function ne(S){return R=void 0,te&&v?F(S):(v=T=void 0,M)}function Te(){R!==void 0&&clearTimeout(R),G=0,v=I=T=R=void 0}function ke(){return R===void 0?M:ne(m())}function ce(){var S=m(),_=z(S);if(v=arguments,T=this,I=S,_){if(R===void 0)return O(I);if(D)return R=setTimeout(H,N),F(I)}return R===void 0&&(R=setTimeout(H,N)),M}return ce.cancel=Te,ce.flush=ke,ce}function x(d){var N=typeof d;return!!d&&(N=="object"||N=="function")}function y(d){return!!d&&typeof d=="object"}function j(d){return typeof d=="symbol"||y(d)&&b.call(d)==t}function P(d){if(typeof d=="number")return d;if(j(d))return e;if(x(d)){var N=typeof d.valueOf=="function"?d.valueOf():d;d=x(N)?N+"":N}if(typeof d!="string")return d===0?d:+d;d=d.replace(r,"");var C=s.test(d);return C||o.test(d)?c(d.slice(2),C?2:8):i.test(d)?e:+d}return ue=f,ue}var Ke=Ye();const Ze=Re(Ke),q=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),et=a=>a===q;var ae=()=>/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"");const oe=(...a)=>a.map(e=>e.trim()).join(" ").trim(),tt=/\s*\((.*?)\)\s*/g,nt=/(\(\?:[^)]+\))\?/g,st=/(\(\?)?:\w+/g,it=/\*/g,rt=/[-{}[\]+?.,\\^$|#]/g,at=a=>a instanceof RegExp?new RegExp(a.source,"i"):(a=a.replace(rt,"\\$&").replace(tt,"(?:$1)?").replace(st,(e,t)=>t?e:"([^\\s]+)").replace(it,"(.*?)").replace(nt,"\\s*$1?\\s*"),new RegExp("^"+a+"$","i")),ot=(a,e)=>{if(a=a.replace(/\s+/g,"").toLowerCase(),e=e.replace(/\s+/g,"").toLowerCase(),!a.length&&!e.length)return 1;if(!a.length||!e.length)return 0;if(a===e)return 1;if(a.length===1&&e.length===1||a.length<2||e.length<2)return 0;const t=new Map;for(let i=0;i<a.length-1;i++){const s=a.substring(i,i+2),o=t.has(s)?t.get(s)+1:1;t.set(s,o)}let r=0;for(let i=0;i<e.length-1;i++){const s=e.substring(i,i+2),o=t.has(s)?t.get(s):0;o>0&&(t.set(s,o-1),r++)}return 2*r/(a.length+e.length-2)},je=()=>typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0);class de{setSpeechRecognition(e){const t=!!e&&(et(e)||je());t&&(this.disableRecognition(),this.recognition=new e,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(t)}subscribe(e,t){this.subscribers[e]=t}unsubscribe(e){delete this.subscribers[e]}emitListeningChange(e){this.listening=e,Object.keys(this.subscribers).forEach(t=>{const{onListeningChange:r}=this.subscribers[t];r(e)})}emitMicrophoneAvailabilityChange(e){this.isMicrophoneAvailable=e,Object.keys(this.subscribers).forEach(t=>{const{onMicrophoneAvailabilityChange:r}=this.subscribers[t];r(e)})}emitTranscriptChange(e,t){Object.keys(this.subscribers).forEach(r=>{const{onTranscriptChange:i}=this.subscribers[r];i(e,t)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(e=>{const{onClearTranscript:t}=this.subscribers[e];t()})}emitBrowserSupportsSpeechRecognitionChange(e){Object.keys(this.subscribers).forEach(t=>{const{onBrowserSupportsSpeechRecognitionChange:r,onBrowserSupportsContinuousListeningChange:i}=this.subscribers[t];r(e),i(e)})}disconnect(e){if(this.recognition&&this.listening)switch(e){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(e){e&&e.error&&e.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:e,resultIndex:t}){const r=t===void 0?e.length-1:t;this.interimTranscript="",this.finalTranscript="";for(let s=r;s<e.length;++s)e[s].isFinal&&(!ae()||e[s][0].confidence>0)?this.updateFinalTranscript(e[s][0].transcript):this.interimTranscript=oe(this.interimTranscript,e[s][0].transcript);let i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(e){this.finalTranscript=oe(this.finalTranscript,e)}resetTranscript(){this.disconnect("RESET")}startListening(){return V(function*({continuous:e=!1,language:t}={}){if(!this.recognition)return;const r=e!==this.recognition.continuous,i=t&&t!==this.recognition.lang;if((r||i)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=r?e:this.recognition.continuous,this.recognition.lang=i?t:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(s){s instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return V(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}stopListening(){return V(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(e=>{this.onStopListening=e})}).call(this)}getRecognition(){return this.recognition}start(){return V(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(e){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(e),ae()&&(this.updateFinalTranscript=Ze(this.updateFinalTranscript,250,{leading:!0}))}}const Ne="CLEAR_TRANSCRIPT",Ce="APPEND_TRANSCRIPT",ct=()=>({type:Ne}),lt=(a,e)=>({type:Ce,payload:{interimTranscript:a,finalTranscript:e}}),ht=(a,e)=>{switch(e.type){case Ne:return{interimTranscript:"",finalTranscript:""};case Ce:return{interimTranscript:e.payload.interimTranscript,finalTranscript:oe(a.finalTranscript,e.payload.finalTranscript)};default:throw new Error}};let U=!!q,ie=U&&!ae(),B;const ut=({transcribing:a=!0,clearTranscriptOnListen:e=!0,commands:t=[]}={})=>{const[r]=h.useState(W.getRecognitionManager()),[i,s]=h.useState(U),[o,c]=h.useState(ie),[{interimTranscript:l,finalTranscript:g},p]=h.useReducer(ht,{interimTranscript:r.interimTranscript,finalTranscript:""}),[u,b]=h.useState(r.listening),[k,w]=h.useState(r.isMicrophoneAvailable),m=h.useRef(t);m.current=t;const f=()=>{p(ct())},x=h.useCallback(()=>{r.resetTranscript(),f()},[r]),y=(v,T,E)=>{const R=(typeof v=="object"?v.toString():v).replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),I=ot(R,T);return I>=E?{command:v,commandWithoutSpecials:R,howSimilar:I,isFuzzyMatch:!0}:null},j=(v,T)=>{const M=at(v).exec(T);return M?{command:v,parameters:M.slice(1)}:null},P=h.useCallback((v,T)=>{m.current.forEach(({command:E,callback:M,matchInterim:R=!1,isFuzzyMatch:I=!1,fuzzyMatchingThreshold:G=.8,bestMatchOnly:ee=!1})=>{const D=!T&&R?v.trim():T.trim(),F=(Array.isArray(E)?E:[E]).map(O=>I?y(O,D,G):j(O,D)).filter(O=>O);if(I&&ee&&F.length>=2){F.sort((H,ne)=>ne.howSimilar-H.howSimilar);const{command:O,commandWithoutSpecials:J,howSimilar:z}=F[0];M(J,D,z,{command:O,resetTranscript:x})}else F.forEach(O=>{if(O.isFuzzyMatch){const{command:J,commandWithoutSpecials:z,howSimilar:H}=O;M(z,D,H,{command:J,resetTranscript:x})}else{const{command:J,parameters:z}=O;M(...z,{command:J,resetTranscript:x})}})})},[x]),d=h.useCallback((v,T)=>{a&&p(lt(v,T)),P(v,T)},[P,a]),N=h.useCallback(()=>{e&&f()},[e]);return h.useEffect(()=>{const v=W.counter;W.counter+=1;const T={onListeningChange:b,onMicrophoneAvailabilityChange:w,onTranscriptChange:d,onClearTranscript:N,onBrowserSupportsSpeechRecognitionChange:s,onBrowserSupportsContinuousListeningChange:c};return r.subscribe(v,T),()=>{r.unsubscribe(v)}},[a,e,r,d,N]),{transcript:oe(g,l),interimTranscript:l,finalTranscript:g,listening:u,isMicrophoneAvailable:k,resetTranscript:x,browserSupportsSpeechRecognition:i,browserSupportsContinuousListening:o}},W={counter:0,applyPolyfill:a=>{B?B.setSpeechRecognition(a):B=new de(a);const e=!!a&&je();U=e,ie=e},removePolyfill:()=>{B?B.setSpeechRecognition(q):B=new de(q),U=!!q,ie=U&&!ae()},getRecognitionManager:()=>(B||(B=new de(q)),B),getRecognition:()=>W.getRecognitionManager().getRecognition(),startListening:({continuous:a,language:e}={})=>V(function*(){yield W.getRecognitionManager().startListening({continuous:a,language:e})})(),stopListening:()=>V(function*(){yield W.getRecognitionManager().stopListening()})(),abortListening:()=>V(function*(){yield W.getRecognitionManager().abortListening()})(),browserSupportsSpeechRecognition:()=>U,browserSupportsContinuousListening:()=>ie},dt=/[.,\/#!$%\^&\*;:{}=\-_`~()。、！？\s\?？]/,K=(a,e)=>{if(!a)return"";let t=a.toLowerCase();return e&&(t=t.replace(/\([^)]*\)|（[^）]*）/g,"")),t.replace(/[.,\/#!$%\^&\*;:{}=\-_`~()。、！？\s\?？]/g,"").replace(/\s+/g,"")},ve=(a,e,t)=>{const r=K(a,!1),i=K(e,t);if(!r||!i)return new Set;const s=r.length,o=i.length,c=Array.from(Array(s+1),()=>Array(o+1).fill(0));for(let u=1;u<=s;u++)for(let b=1;b<=o;b++)r[u-1]===i[b-1]?c[u][b]=c[u-1][b-1]+1:c[u][b]=Math.max(c[u-1][b],c[u][b-1]);let l=s,g=o;const p=new Set;for(;l>0&&g>0;)r[l-1]===i[g-1]?(p.add(g-1),l--,g--):c[l-1][g]>c[l][g-1]?l--:g--;return p},gt=(a,e,t)=>{const r=new Set;let i=0,s=!1;for(let o=0;o<e.length;o++){const c=e[o];if(t){if(c==="("||c==="（"){s=!0;continue}if(c===")"||c==="）"){s=!1;continue}if(s)continue}dt.test(c)||(a.has(i)&&r.add(o),i++)}return r},ft=(a,e="ja-JP",t=!0)=>{const[r,i]=h.useState(0),[s,o]=h.useState(new Set),{transcript:c,listening:l,resetTranscript:g,browserSupportsSpeechRecognition:p,isMicrophoneAvailable:u,error:b}=ut();return h.useEffect(()=>()=>{},[]),h.useEffect(()=>{if(!c)return;const m=ve(c,a,t),f=gt(m,a,t);o(f);const x=K(a,t);l&&x.length>0&&m.size===x.length&&i(100)},[c,a,l,t]),h.useEffect(()=>{if(!l&&c&&a&&r!==100){const m=ve(c,a,t),x=K(a,t).length;if(x===0){i(0);return}let y=m.size/x*100;K(c,!1).length>x*1.5&&(y*=.8);let j=Math.floor(y);j>100&&(j=100),i(j)}},[l]),{transcript:c,listening:l,score:r,matchedIndices:s,startRecording:()=>{i(0),o(new Set),g()},stopRecording:()=>{},isSupported:p,hasMic:u,error:b}},pt=h.memo(({setStatus:a})=>n.jsx("div",{className:"flex items-center gap-1 cursor-pointer bg-gray-100 text-gray-600 hover:bg-gray-200 p-2 rounded-full transition-all",onClick:()=>a(!1),children:n.jsx(A,{iconName:"faClose"})})),xt=a=>/[.,\/#!$%\^&\*;:{}=\-_`~()。、！？\s\?？]/.test(a),mt=h.memo(({text:a,matchedIndices:e})=>{const t=a.length>50?"text-base sm:text-lg":"text-xl sm:text-2xl";return n.jsx("div",{className:`${t} font-medium leading-loose flex flex-wrap gap-x-[1px] text-left transition-all duration-300`,children:a.split("").map((r,i)=>{let s=e.has(i);return!s&&xt(r)&&i>0&&e.has(i-1)&&(s=!0),n.jsx("span",{className:`transition-colors duration-200 ${s?"text-green-600 font-bold":"text-gray-400"}`,children:r},i)})})}),yt=h.memo(({score:a,visible:e})=>n.jsxs("div",{className:`w-full transition-all duration-500 ease-out overflow-hidden ${e?"max-h-20 opacity-100 mt-3":"max-h-0 opacity-0 mt-0"}`,children:[n.jsxs("div",{className:"flex justify-between items-center mb-1",children:[n.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider",children:"Chính xác"}),n.jsxs("span",{className:`text-sm font-black transition-colors ${a>=80?"text-green-600":"text-orange-500"}`,children:[a,"%"]})]}),n.jsx("div",{className:"w-full bg-gray-200 h-1.5 rounded-full overflow-hidden",children:n.jsx("div",{className:`h-full transition-all duration-1000 ease-out ${a>=80?"bg-green-500":"bg-orange-500"}`,style:{width:`${e?a:0}%`}})})]})),bt=({value:a,language:e,setStatus:t})=>{const r=a||"日本語",i=e||"ja-JP",[s,o]=h.useState(!0),[c,l]=h.useState(!1),g=h.useRef(null),{transcript:p,score:u,matchedIndices:b,startRecording:k,isSupported:w,error:m}=ft(r,i,s);h.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),h.useEffect(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[p]),h.useEffect(()=>{u===100&&c&&l(!1)},[u,c]);const f=j=>{j.cancelable&&j.type!=="mousedown"&&j.preventDefault(),l(!0),k()},x=j=>{j.cancelable&&j.type!=="mouseup"&&j.preventDefault(),u!==100&&l(!1)};if(!w)return null;const y=!c&&u===100;return n.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-[100] p-4 bg-black/60 backdrop-blur-sm",children:[y&&n.jsx("div",{className:"absolute inset-0 z-[200] pointer-events-none",children:n.jsx(Qe,{width:window.innerWidth,height:window.innerHeight,recycle:!1,numberOfPieces:400,gravity:.2})}),n.jsxs("div",{className:"bg-white w-full max-w-lg max-h-[85vh] rounded-[20px] shadow-2xl flex flex-col overflow-hidden animate-in zoom-in duration-300 relative z-10",children:[n.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b border-gray-100 bg-white z-20 shrink-0",children:[n.jsxs("h2",{className:"text-base font-bold text-gray-800 flex items-center gap-2 uppercase tracking-wide",children:[n.jsx(Oe,{className:"text-blue-500 text-lg"})," Luyện nói"]}),n.jsx(pt,{setStatus:t})]}),n.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar bg-gray-50/50",children:[n.jsxs("div",{className:"bg-white rounded-xl p-5 border border-gray-100 shadow-sm mb-3",children:[n.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-3 gap-2",children:[n.jsx("span",{className:"text-[10px] font-black text-blue-800 uppercase tracking-widest bg-blue-50 px-2 py-1 rounded",children:"Nội dung gốc"}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(re,{text:r,language:i}),n.jsxs("button",{onClick:()=>o(!s),className:"flex items-center gap-1 px-2 py-1 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors border border-transparent hover:border-gray-200",children:[s?n.jsx(Pe,{className:"text-green-500"}):n.jsx(Ee,{className:"text-gray-400"}),n.jsx("span",{className:"text-[10px] font-bold text-gray-600 whitespace-nowrap",children:"Bỏ ngoặc"})]})]})]}),n.jsx("div",{className:"break-words",children:n.jsx(mt,{text:r,matchedIndices:b})})]}),n.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm flex flex-col transition-all duration-300",children:[n.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase mb-2 flex items-center gap-2 shrink-0",children:["Giọng đọc của bạn",c&&n.jsx("span",{className:"w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse"})]}),n.jsx("div",{ref:g,className:"max-h-[100px] overflow-y-auto custom-scrollbar pr-1 scroll-smooth",children:n.jsx("p",{className:`text-sm leading-relaxed break-words transition-colors duration-300 ${p?"text-gray-800":"text-gray-300 italic"}`,children:p||"Nhấn giữ nút bên dưới và bắt đầu đọc..."})}),n.jsx(yt,{score:u,visible:!c&&u>0})]})]}),n.jsxs("div",{className:"p-3 border-t border-gray-100 bg-white flex flex-col items-center z-20 shrink-0 select-none pb-5",children:[m&&n.jsx("div",{className:"mb-2 px-3 py-1 bg-red-50 text-red-500 text-[10px] rounded border border-red-100 max-w-[90%] text-center truncate",children:m.message||"Lỗi Micro"}),n.jsxs("div",{className:"relative flex items-center justify-center",children:[c&&n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"absolute w-16 h-16 bg-red-500/30 rounded-full animate-radio-wave-slow"}),n.jsx("div",{className:"absolute w-16 h-16 bg-red-500/50 rounded-full animate-radio-wave-fast"})]}),n.jsx("button",{onMouseDown:f,onMouseUp:x,onMouseLeave:x,onTouchStart:f,onTouchEnd:x,onTouchCancel:x,className:`relative z-10 w-16 h-16 rounded-full flex items-center justify-center transition-all duration-200 shadow-lg hover:shadow-xl select-none touch-none outline-none ${c?"bg-red-500 scale-95 ring-4 ring-red-100":"bg-gradient-to-br from-blue-600 to-blue-700 hover:scale-105"}`,style:{WebkitTapHighlightColor:"transparent"},children:n.jsx(Ae,{size:28,className:"text-white pointer-events-none"})})]}),n.jsx("p",{className:`mt-2 text-[10px] font-bold tracking-widest uppercase transition-colors duration-300 ${c?"text-red-500":"text-gray-400"}`,children:c?"Đang thu âm...":"Giữ để nói"})]})]})]})};function Se({value:a,language:e}){const[t,r]=h.useState(!1);return n.jsxs("div",{children:[n.jsx(we,{title:t?"Tắt đọc":"Đọc",className:"cursor-pointer mt-1 p-1 rounded-full shadow shadow-gray-800",onClick:()=>{r(!t)},children:n.jsx(A,{iconName:t?"faMicrophoneLinesSlash":"faMicrophoneLines",className:`${t?"bg-sky-500 text-white":""} transition-all aspect-1/1  text-gray-800 dark:text-white`})}),t&&n.jsx(bt,{value:a,language:e,setStatus:r})]})}const vt=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]}));function wt({title:a}){const{inputText:e,aiCallBack:t,isLoading:r,error:i}=h.useContext(X),{romaji:s,japanese:o}=t||{},c=()=>r?n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}):i?n.jsxs("p",{className:"text-red-500",children:["Lỗi: ",i.message||"Đã có lỗi xảy ra"]}):e?n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800",children:"Nội dung:"}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx(re,{text:e,language:"vi-VN"}),n.jsx("p",{children:e})]})]}),o&&n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800",children:"Dịch:"}),n.jsxs("div",{className:"flex gap-2 items-center",children:[n.jsx(re,{text:o,language:"ja-JP"}),n.jsx(Se,{value:o,language:"ja-JP"}),n.jsx("p",{children:o})]})]}),s&&n.jsxs("div",{children:[n.jsx("b",{className:"text-sky-800 italic text-sm",children:"Cách đọc:"}),n.jsx("p",{children:s})]})]}):n.jsx("p",{children:"Vui lòng nhập nội dung cần dịch."});return n.jsxs("div",{className:"w-full shadow shadow-gray-400  rounded-b-2xl p-5 ",children:[n.jsx(vt,{title:a||"Dịch - Cách đọc"}),c()]})}const jt=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),Nt=h.memo(({item:a})=>{const{special_structure:e,html:t,analysis:r}=a||{},i=o=>o?o.replace(/Aい/g,"A<sub>い</sub><sub class='text-gray-800 italic'>( Tính từ đuôi い)</sub>").replace(/Aな/g,"A<sub>な</sub><sub class='text-gray-800 italic'>( Tính từ đuôi な)</sub>").replace(/V(る|て|た|ない)/g,"V<sub>$1</sub>").replace("V-masu","V<sub>ます</sub>").replace("N/Na-adj","N<sub class='text-gray-800 italic'>( Danh từ )</sub>").replace(/\*\*(.*?)\*\*/g,"<br><b>$1</b><br>"):"",s=h.useMemo(()=>i(String(e)||""),[e]);return n.jsx(we,{title:`Chi tiết cấu trúc:${e}`||"",placement:"top",arrow:!0,children:n.jsxs("details",{className:"group cursor-pointer p-3 border-b last:border-0 border-gray-100 dark:border-gray-700",children:[n.jsx("summary",{className:"flex items-center justify-between list-none outline-none",children:n.jsx("div",{className:"text-sky-800 dark:text-sky-400 font-bold text-lg hover:text-sky-600 transition-colors",dangerouslySetInnerHTML:{__html:s}})}),n.jsx("div",{className:"grid grid-rows-[0fr] transition-all duration-300 ease-in-out group-open:grid-rows-[1fr]",children:n.jsx("div",{className:"overflow-hidden",children:n.jsx("div",{className:"pt-3 pl-4 border-l-2 border-gray-200 dark:border-gray-600 ml-1 mt-1",children:n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic",children:r})})})})]})})});function Ct({title:a}){const{aiCallBack:e,isLoading:t,error:r}=h.useContext(X),{list_structure:i}=e||{};return n.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[n.jsx(jt,{title:a||"Phân tích"}),t&&n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}),(i==null?void 0:i.length)>0&&!t&&n.jsx("div",{className:"mt-2",children:n.jsx("ul",{className:" list-inside flex  flex-col gap-5",children:i.map((s,o)=>n.jsx("li",{className:"shadow shadow-gray-400 p-2 rounded-2xl",children:n.jsx(Nt,{item:s})},o))})}),!t&&(!i||i.length===0)&&n.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Không tìm thấy cấu trúc ngữ pháp đặc biệt."})]})}const St=h.memo(({title:a})=>n.jsxs("span",{className:"flex items-center",children:[n.jsx("span",{className:"h-px flex-1 bg-gradient-to-r from-transparent to-gray-300 dark:to-gray-600"}),n.jsx("span",{className:"shrink-0 px-4 text-red-800 dark:text-white font-bold text-xl",children:a}),n.jsx("span",{className:"h-px flex-1 bg-gradient-to-l from-transparent to-gray-300 dark:to-gray-600"})]})),Tt=h.memo(({item:a})=>n.jsxs("li",{className:"w-full h-full shadow shadow-gray-400 p-2 rounded-2xl bg-white dark:bg-gray-900",children:[n.jsxs("div",{className:"flex justify-between items-center gap-2",children:[n.jsxs("div",{className:"flex gap-2 items-center text-xl text-sky-800 dark:text-sky-200",children:[n.jsx(ze,{}),n.jsx("span",{className:"font-Japan font-bold",children:a==null?void 0:a.word})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx(re,{text:a==null?void 0:a.word,language:"ja-JP"}),n.jsx(Se,{value:a==null?void 0:a.word,language:"ja-JP"})]})]}),n.jsx("div",{className:"bg-gray-100 dark:bg-gray-800 rounded-xl p-2 mt-2",children:n.jsx("p",{className:"text-sm lg:text-base",children:a==null?void 0:a.meaning})})]}));function kt({title:a}){const{aiCallBack:e,isLoading:t,error:r}=h.useContext(X),{list_vocabulary:i}=e||{};return n.jsxs("div",{className:"w-full shadow shadow-gray-400 rounded-b-2xl p-5 ",children:[n.jsx(St,{title:a||"Phân tích"}),t&&n.jsxs("div",{className:"flex flex-col gap-2 items-center",children:[n.jsx(ge,{}),n.jsx("p",{className:"text-sky-800 animate-pulse",children:"Đang phân tích"})]}),(i==null?void 0:i.length)>0&&!t&&n.jsx("div",{className:"mt-2",children:n.jsx("ul",{className:" grid grid-cols-1 md:grid-cols-3 lg:grid-cols-4 gap-5",children:i.map((s,o)=>{const c=s!=null&&s.word?`${s.word}-${o}`:o;return n.jsx(Tt,{item:s},c)})})}),!t&&(!i||i.length===0)&&n.jsx("p",{className:"text-center text-gray-400 mt-4 text-sm",children:"Không tìm thấy từ vựng đặc biệt."})]})}const Rt=h.memo(kt);function Mt({aiCallBack:a}){const[e,t]=Z.useState("tab1");h.useEffect(()=>{a&&t("tab1")},[a]);const r=(i,s)=>"dark:text-white flex-1 text-center py-1  px-4 flex items-center justify-center gap-2 text-lg font-medium border-b-4 transition-all duration-300 "+(s===i?"border-indigo-700 text-indigo-800":"border-transparent text-gray-600  hover:text-gray-800 hover:border-gray-300 dark:hover:text-white");return n.jsxs("section",{children:[n.jsxs("nav",{className:"flex justify-between bg-white dark:bg-gray-800  border-b border-gray-200 rounded-t-lg",children:[n.jsxs("button",{onClick:()=>t("tab1"),className:r("tab1",e),children:[n.jsx(De,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Dịch - cách đọc"})]}),n.jsxs("button",{onClick:()=>t("tab2"),className:r("tab2",e),children:[n.jsx(He,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Phân tích cấu trúc"})]}),n.jsxs("button",{onClick:()=>t("tab3"),className:r("tab3",e),children:[n.jsx(Fe,{className:"text-xl"}),n.jsx("span",{className:"hidden md:block",children:"Danh sách từ vựng"})]})]}),n.jsxs("div",{className:"",children:[e==="tab1"&&n.jsx(wt,{title:"Dịch"}),e==="tab2"&&n.jsx(Ct,{title:"Cấu trúc"}),e==="tab3"&&n.jsx(Rt,{title:"Từ vựng"})]})]})}function It(){const{aiCallBack:a,isLoading:e}=h.useContext(X);return n.jsxs("div",{children:[n.jsxs("div",{className:"flex flex-col  md:flex-row justify-between gap-2 items-center",children:[n.jsxs("div",{className:"flex gap-2",children:[n.jsx(A,{iconName:"faCrown",className:"text-2xl text-yellow-500"}),n.jsx("h1",{className:"text-2xl font-bold",children:"Phân tích"})]}),n.jsx("h5",{className:"text-gray-400 text-sm italic",children:location.href})]}),n.jsx("div",{className:"flex flex-col gap-5 select-text mt-2",children:n.jsx(Mt,{aiCallBack:a})})]})}function Lt({onClose:a,onRepeat:e}){const[t,r]=h.useState([]),i=()=>{try{const c=localStorage.getItem("dichHistory");if(c){const g=JSON.parse(c).map(p=>{const u=atob(p),b=decodeURIComponent(u);return JSON.parse(b)});r(g)}else r([])}catch(c){console.error("Failed to load history from localStorage:",c),localStorage.removeItem("dichHistory"),r([])}};h.useEffect(()=>{i()},[]);const s=()=>{window.confirm("Bạn có chắc chắn muốn xóa TOÀN BỘ lịch sử dịch? Thao tác này không thể hoàn tác.")&&(localStorage.removeItem("dichHistory"),r([]))},o=c=>{if(window.confirm("Bạn có chắc chắn muốn xóa mục này?")){const l=t.filter(p=>p.id!==c),g=l.map(p=>{const u=JSON.stringify(p);return btoa(encodeURIComponent(u))});localStorage.setItem("dichHistory",JSON.stringify(g)),r(l)}};return n.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 flex justify-center items-center",onClick:a,children:n.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-xl w-[90%] max-w-2xl max-h-[80vh] flex flex-col",onClick:c=>c.stopPropagation(),children:[n.jsxs("header",{className:"flex flex-wrap justify-between items-center p-4 border-b dark:border-gray-600",children:[n.jsxs("h2",{className:"text-xl font-bold text-sky-800 dark:text-sky-400",children:[n.jsx(A,{iconName:"faClipboardList",className:"mr-2"}),"Lịch sử đã lưu"]}),n.jsxs("div",{className:"flex items-center justify-end  gap-4",children:[t.length>0&&n.jsxs("button",{onClick:s,title:"Xóa toàn bộ lịch sử",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:[n.jsx(A,{iconName:"faTrashCan"}),n.jsx("span",{children:"Xóa tất cả"})]}),n.jsx("button",{onClick:a,className:"text-gray-600 border border-gray-300 px-3 py-1.5 text-sm font-medium rounded-md hover:text-red-800 dark:text-gray-300 dark:hover:text-white",children:"Đóng"})]})]}),n.jsx("main",{className:"p-5 overflow-y-auto",children:t.length>0?n.jsx("ul",{className:"space-y-3",children:t.slice().reverse().map(c=>{var l;return n.jsxs("li",{className:"flex flex-col gap-2 md:flex-row justify-between w-full  items-center p-2 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[n.jsxs("div",{className:"w-full md:w-fit flex items-center justify-between px-2 gap-2 md:border-r md:pr-2 mr-4",children:[n.jsx("button",{onClick:()=>e(c),title:"Dùng lại",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-sky-700 hover:text-sky-900 dark:text-sky-400 dark:hover:text-sky-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:n.jsx(A,{iconName:"faRepeat"})}),n.jsx("button",{onClick:()=>o(c.id),title:"Xóa mục này",className:"flex items-center gap-2 px-3 py-1.5 text-sm font-medium text-red-800 hover:text-red-900 dark:text-red-400 dark:hover:text-red-200 border border-gray-300 dark:border-gray-500 rounded-md hover:bg-gray-100 dark:hover:bg-gray-600 transition-colors",children:n.jsx(A,{iconName:"faTrashCan"})})]}),n.jsxs("div",{className:"w-full overflow-hidden px-2 mr-4",children:[n.jsx("p",{className:"text-gray-800 dark:text-gray-200 truncate",title:c.inputText,children:c.inputText}),n.jsxs("div",{className:" flex gap-2 text-xs italic text-gray-500 dark:text-gray-400 mt-1",children:[n.jsx("p",{children:"Phong cách : "}),n.jsx("p",{children:((l=c.options)==null?void 0:l.theLoaiGiaoTiep)||"không rõ"})]})]})]},c.id)})}):n.jsx("p",{className:"text-center text-gray-500 dark:text-gray-400",children:"Chưa có lịch sử nào được lưu."})})]})})}function Ot({text:a,handleErase:e,handleButtonClick:t,isSendDisabled:r,handleHistoryClick:i}){return n.jsxs("div",{className:"flex items-center justify-end gap-2 p-1.5 ",children:[n.jsxs("button",{type:"button",onClick:i,title:"Xem lịch sử",className:"dark:text-white group flex items-center gap-1 transition-all justify-center rounded border border-gray-300 hover:border-sky-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-sky-900",children:[n.jsx(A,{iconName:"faClipboardList"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Lịch sử"})]}),n.jsxs("button",{type:"button",className:`${a.length>0?"opacity-100":"opacity-0 pointer-events-none"} dark:text-white group flex items-center gap-1 transition-all rounded border border-gray-300 hover:border-red-800 px-3 py-1.5 text-sm font-medium text-gray-700 hover:text-red-900`,onClick:e,children:[n.jsx(A,{iconName:"faEraser"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Xóa"})]}),n.jsxs("button",{type:"button",onClick:t,disabled:r,className:`dark:text-white rounded group flex items-center gap-1 border border-gray-300 px-3 py-1.5 text-sm font-medium shadow-sm transition-colors hover:bg-gray-100 ${r?"opacity-50 cursor-not-allowed text-gray-900":"cursor-pointer text-sky-600"}`,children:[n.jsx(A,{iconName:"faPaperPlane"}),n.jsx("p",{className:"h-0 w-0 opacity-0 group-hover:opacity-100 group-hover:h-auto group-hover:w-auto transition-all overflow-hidden whitespace-nowrap",children:"Dịch"})]})]})}function Pt({text:a,handleChange:e}){return n.jsx("textarea",{id:"Notes",className:"w-full resize-none border-none focus:ring-0 sm:text-sm outline-none h-full px-3 py-2",placeholder:"Ví dụ : Tiếng nhật khó nhưng thú vị.",value:a,onChange:e})}function Et({options:a,onOptionChange:e}){const t=r=>{e({...a,theLoaiGiaoTiep:r.target.value})};return n.jsx("div",{className:"w-full p-2",children:n.jsxs("label",{htmlFor:"theLoaiGiaoTiep",className:"cursor-pointer w-full",children:[n.jsx("div",{className:"text-sm font-medium border-b w-full text-gray-700 dark:text-gray-200",children:n.jsx("p",{children:"Thể loại giao tiếp"})}),n.jsxs("select",{onChange:t,name:"theLoaiGiaoTiep",id:"theLoaiGiaoTiep",value:(a==null?void 0:a.theLoaiGiaoTiep)||"lịch sự",className:"mt-0.5 p-1 w-full rounded-b-xl border border-gray-300 shadow-sm outline-none text-sm dark:border-gray-600 dark:bg-gray-900 dark:text-white",children:[n.jsx("option",{value:"lịch sự",children:"Lịch sự"}),n.jsx("option",{value:"thông thường",children:"Thông thường"}),n.jsx("option",{value:"suồng sã",children:"Suồng sã"}),n.jsx("option",{value:"cục súc",children:"Cục súc"}),n.jsx("option",{value:"nói với cấp trên",children:"Nói với cấp trên"}),n.jsx("option",{value:"nói với cấp dưới",children:"Nói với cấp dưới"}),n.jsx("option",{value:"nói với đồng nghiệp",children:"Nói với đồng nghiệp"})]})]})})}function At(){const{options:a,inputText:e,setInputText:t,setOptions:r}=h.useContext(X),[i,s]=h.useState(""),[o,c]=h.useState(!1);h.useEffect(()=>{s(e)},[e]),h.useEffect(()=>{const w=m=>{if(!m.ctrlKey)return;const f=m.key.toLowerCase();if(f==="enter"){m.preventDefault(),g();return}if(f==="h"){m.preventDefault(),u();return}if(f==="x"){m.preventDefault(),p();return}};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[i,e]);const l=w=>{s(w.target.value)},g=()=>{i.length>0&&t(i)},p=()=>{window.confirm("Xoá toàn bộ nội dung của bạn?")&&(s(""),t(""))},u=()=>{c(!o)},b=w=>{window.confirm("Bạn có muốn sử dụng lại nội dung này?")&&(t(w.inputText),r(w.options),u())},k=i.length===0||i===e;return n.jsxs("div",{className:"w-full h-full",children:[n.jsxs("label",{htmlFor:"Notes",children:[n.jsxs("div",{className:"flex justify-start items-center gap-2",children:[n.jsx(A,{iconName:"faLanguage",className:"text-2xl text-sky-800"}),n.jsx("span",{className:"text-2xl font-bold",children:"Tôi muốn nói"})]}),n.jsxs("div",{className:"relative h-full flex flex-col mt-0.5 overflow-hidden rounded-2xl border border-gray-300 shadow-sm focus-within:ring focus-within:ring-green-600 ",children:[n.jsxs("div",{children:[n.jsx(Pt,{text:i,handleChange:l}),n.jsx(Ot,{text:i,handleErase:p,handleButtonClick:g,isSendDisabled:k,handleHistoryClick:u})]}),n.jsx(Et,{options:a,onOptionChange:r})]})]}),n.jsxs("div",{className:"flex flex-col justify-start",children:[n.jsx("p",{className:"text-xs text-sky-500 mt-1 italic",children:"* Nội dung được dịch bằng AI"}),n.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Phím tắt: Ctrl+Enter = Dịch · Ctrl+H = Lịch sử · Ctrl+X = Xóa"})]}),o&&n.jsx(Lt,{onClose:u,onRepeat:b})]})}const Dt=()=>{const{generateContent:a}=Le();return{dichCachDoc:async(t,r)=>{if(r!=null&&r.theLoaiGiaoTiep,!t||typeof t!="string")return{error:"Dữ liệu đầu vào không hợp lệ"};const i=`
        Role: JLPT Expert.
        Task: Process "${t}".
        Logic:
        1. If input is NOT Japanese, translate it into natural Japanese.
        2. If input IS Japanese, use it directly.
        3. Analyze grammar and vocabulary.
        4. All explanations/meanings must be in VIETNAMESE.

        Output: Minified RAW JSON only (No Markdown, no whitespace).

        Schema:
        {
            "japanese": "Japanese text",
            "romaji": "Romaji",
            "list_vocabulary": [
                {
                    "word": "Word",
                    "meaning": "Vietnamese meaning"
                }
            ],
            "list_structure": [
                {
                    "special_structure": "Grammar Name Vietnamese explanation",
                    "analysis": "Short Vietnamese explanation"
                }
            ]
        }`;try{const s=await a(i);s.startsWith("Lỗi")&&alert("Lỗi : Máy chủ Google AI đang quá tải. Thử lại sau 1 phút.");const o=s.match(/\{[\s\S]*\}/);return o?JSON.parse(o[0]):null}catch{return{original:t,japanese:"Lỗi: Máy chủ Google AI đang bảo trì. Thử lại sau 1-2 phút. @@",romaji:"",list_vocabulary:[{word:"",meaning:""}],list_structure:[{special_structure:"",analysis:"T.T"}]}}}}},X=h.createContext({options:{},inputText:"",aiCallBack:"",isLoading:!1,error:null,setInputText:()=>{},setOptions:()=>{}});function Ut(){const a=Me(),{dichCachDoc:e}=Dt(),[t,r]=h.useState(""),[i,s]=h.useState(""),[o,c]=h.useState({theLoaiGiaoTiep:"lịch sự"}),[l,g]=h.useState(!1),[p,u]=h.useState(null);h.useEffect(()=>{window.scrollY&&window.scrollTo({top:0,behavior:"smooth"})},[]);const b=(k,w,m)=>{try{const f=localStorage.getItem("dichHistory")||"[]",y=JSON.parse(f).map(C=>JSON.parse(decodeURIComponent(atob(C))));if(y.some(C=>C.inputText===k&&JSON.stringify(C.options)===JSON.stringify(w))){console.log("Mục giống hệt đã tồn tại, không lưu.");return}const P={id:Date.now(),inputText:k,options:w,aiCallBack:m},d=y.findLastIndex(C=>C.inputText===k);d!==-1?(console.log(`Tìm thấy nhóm cho '${k}'. Chèn vào sau vị trí ${d}.`),y.splice(d+1,0,P)):y.push(P);const N=y.map(C=>{const v=JSON.stringify(C);return btoa(encodeURIComponent(v))});localStorage.setItem("dichHistory",JSON.stringify(N))}catch(f){console.error("Lỗi khi tự động lưu lịch sử:",f)}};return h.useEffect(()=>{if(!i){r(""),u(null),g(!1);return}const w=(()=>{try{const f=localStorage.getItem("dichHistory")||"[]",y=JSON.parse(f).find(j=>{const P=JSON.parse(decodeURIComponent(atob(j)));return P.inputText===i&&JSON.stringify(P.options)===JSON.stringify(o)});return y?JSON.parse(decodeURIComponent(atob(y))):null}catch{return null}})();if(w){console.log("Tìm thấy kết quả trong cache."),r(w.aiCallBack),g(!1),u(null);return}(async()=>{g(!0),u(null);try{const f=await e(i,o);b(i,o,f),r(f)}catch(f){f.response&&f.response.status===429&&alert("Bạn đã gửi quá nhiều yêu cầu. Vui lòng thử lại sau một lát."),u(f),r("")}finally{g(!1)}})()},[i,o]),n.jsx(X.Provider,{value:{options:o,inputText:i,aiCallBack:t,isLoading:l,error:p,setOptions:c,setInputText:s},children:n.jsxs("section",{className:"min-h-screen px-5 mb-5 xl:p-0",children:[n.jsx("div",{className:"mb-5",children:a}),n.jsx(Ie,{}),n.jsxs("div",{className:"w-full flex flex-col gap-10",children:[n.jsx(At,{}),n.jsx(It,{})]})]})})}export{X as DichContext,Ut as default};
